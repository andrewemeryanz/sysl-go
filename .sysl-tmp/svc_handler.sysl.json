{
 "apps": {
  "CodeGenTransform": {
   "name": {
    "part": [
     "CodeGenTransform"
    ]
   },
   "views": {
    "EpHandlerMethodDecl": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "packageName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "sequence": {
       "typeRef": {
        "context": {
         "appname": {
          "part": [
           "CodeGenTransform"
          ]
         },
         "path": [
          "EpHandlerMethodDecl"
         ]
        },
        "ref": {
         "path": [
          "TopLevelDecl"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "binexpr": {
         "op": "WHERE",
         "lhs": {
          "getAttr": {
           "arg": {
            "name": "app"
           },
           "attr": "endpoints"
          }
         },
         "rhs": {
          "binexpr": {
           "op": "EQ",
           "lhs": {
            "getAttr": {
             "arg": {
              "getAttr": {
               "arg": {
                "name": "."
               },
               "attr": "value"
              }
             },
             "attr": "is_rest"
            }
           },
           "rhs": {
            "literal": {
             "b": true
            },
            "type": {
             "primitive": "BOOL"
            }
           }
          }
         },
         "scopevar": "."
        }
       },
       "scopevar": "ep",
       "stmt": [
        {
         "let": {
          "name": "implFuncName",
          "expr": {
           "getAttr": {
            "arg": {
             "call": {
              "func": "methodDef",
              "arg": [
               {
                "name": "ep"
               }
              ]
             }
            },
            "attr": "methodName"
           }
          }
         }
        },
        {
         "let": {
          "name": "funcName",
          "expr": {
           "binexpr": {
            "op": "ADD",
            "lhs": {
             "name": "implFuncName"
            },
            "rhs": {
             "literal": {
              "s": "Handler"
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "allParams",
          "expr": {
           "call": {
            "func": "getAllParams",
            "arg": [
             {
              "name": "ep"
             },
             {
              "name": "module"
             }
            ]
           }
          }
         }
        },
        {
         "assign": {
          "name": "Comment",
          "expr": {
           "binexpr": {
            "op": "ADD",
            "lhs": {
             "binexpr": {
              "op": "ADD",
              "lhs": {
               "literal": {
                "s": "// "
               }
              },
              "rhs": {
               "name": "funcName"
              }
             }
            },
            "rhs": {
             "literal": {
              "s": " ..."
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "MethodDecl",
          "expr": {
           "transform": {
            "arg": {
             "name": "ep"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Receiver",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "ep"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "ReceiverType",
                    "expr": {
                     "literal": {
                      "s": "s *ServiceHandler"
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Receiver"
                    ]
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "FunctionName",
               "expr": {
                "name": "funcName"
               }
              }
             },
             {
              "assign": {
               "name": "Signature",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "ep"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "Parameters",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "ParameterList",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "ParameterDecl",
                              "expr": {
                               "call": {
                                "func": "paramDecl",
                                "arg": [
                                 {
                                  "literal": {
                                   "s": "w"
                                  }
                                 },
                                 {
                                  "literal": {
                                   "s": "http.ResponseWriter"
                                  }
                                 }
                                ]
                               }
                              }
                             }
                            },
                            {
                             "assign": {
                              "name": "ParameterDeclC",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "list": {
                                  "expr": [
                                   {
                                    "name": "ep"
                                   }
                                  ]
                                 }
                                },
                                "scopevar": "p",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "ParameterDecl",
                                   "expr": {
                                    "call": {
                                     "func": "paramDecl",
                                     "arg": [
                                      {
                                       "literal": {
                                        "s": "r"
                                       }
                                      },
                                      {
                                       "literal": {
                                        "s": "*http.Request"
                                       }
                                      }
                                     ]
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "sequence": {
                                 "typeRef": {
                                  "context": {
                                   "appname": {
                                    "part": [
                                     "CodeGenTransform"
                                    ]
                                   },
                                   "path": [
                                    "EpHandlerMethodDecl"
                                   ]
                                  },
                                  "ref": {
                                   "path": [
                                    "ParameterDeclC"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "ParameterList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Parameters"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Signature"
                    ]
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "let": {
               "name": "hasPayload",
               "expr": {
                "ifelse": {
                 "cond": {
                  "binexpr": {
                   "op": "GT",
                   "lhs": {
                    "call": {
                     "func": ".count",
                     "arg": [
                      {
                       "getAttr": {
                        "arg": {
                         "getAttr": {
                          "arg": {
                           "name": "ep"
                          },
                          "attr": "value"
                         }
                        },
                        "attr": "ret"
                       }
                      }
                     ]
                    }
                   },
                   "rhs": {
                    "literal": {
                     "i": "0"
                    }
                   }
                  }
                 },
                 "ifTrue": {
                  "literal": {
                   "b": true
                  },
                  "type": {
                   "primitive": "BOOL"
                  }
                 },
                 "ifFalse": {
                  "literal": {
                   "b": false
                  },
                  "type": {
                   "primitive": "BOOL"
                  }
                 }
                }
               }
              }
             },
             {
              "let": {
               "name": "returnValues",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "getAttr": {
                   "arg": {
                    "call": {
                     "func": "makeResult",
                     "arg": [
                      {
                       "name": "ep"
                      }
                     ]
                    }
                   },
                   "attr": "out"
                  }
                 },
                 "rhs": {
                  "literal": {
                   "s": ",err"
                  }
                 }
                }
               }
              }
             },
             {
              "let": {
               "name": "sendRespCallArgs",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "binexpr": {
                   "op": "ADD",
                   "lhs": {
                    "literal": {
                     "s": "httpstatus,"
                    }
                   },
                   "rhs": {
                    "getAttr": {
                     "arg": {
                      "call": {
                       "func": "makeResult",
                       "arg": [
                        {
                         "name": "ep"
                        }
                       ]
                      }
                     },
                     "attr": "out"
                    }
                   }
                  }
                 },
                 "rhs": {
                  "literal": {
                   "s": ",err"
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "Block",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "ep"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "let": {
                    "name": "nilCheck",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "implFuncName"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "implFuncName"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "IfElseStmt",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "implFuncName"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "Expression",
                                   "expr": {
                                    "call": {
                                     "func": "makeValueExpr",
                                     "arg": [
                                      {
                                       "binexpr": {
                                        "op": "ADD",
                                        "lhs": {
                                         "binexpr": {
                                          "op": "ADD",
                                          "lhs": {
                                           "literal": {
                                            "s": "s.serviceInterface."
                                           }
                                          },
                                          "rhs": {
                                           "name": "implFuncName"
                                          }
                                         }
                                        },
                                        "rhs": {
                                         "literal": {
                                          "s": " == nil"
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "Block",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "implFuncName"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "let": {
                                        "name": "handleError",
                                        "expr": {
                                         "call": {
                                          "func": "makeFunctionCall",
                                          "arg": [
                                           {
                                            "literal": {
                                             "s": "s.HandleError"
                                            }
                                           },
                                           {
                                            "call": {
                                             "func": "makeValueExpr",
                                             "arg": [
                                              {
                                               "literal": {
                                                "s": "r.Context()"
                                               }
                                              }
                                             ]
                                            }
                                           },
                                           {
                                            "list": {
                                             "expr": [
                                              {
                                               "call": {
                                                "func": "makeValueExpr",
                                                "arg": [
                                                 {
                                                  "literal": {
                                                   "s": "w"
                                                  }
                                                 }
                                                ]
                                               }
                                              },
                                              {
                                               "call": {
                                                "func": "makeValueExpr",
                                                "arg": [
                                                 {
                                                  "literal": {
                                                   "s": "common.InternalError"
                                                  }
                                                 }
                                                ]
                                               }
                                              },
                                              {
                                               "call": {
                                                "func": "makeValueExpr",
                                                "arg": [
                                                 {
                                                  "literal": {
                                                   "s": "\"not implemented\""
                                                  }
                                                 }
                                                ]
                                               }
                                              },
                                              {
                                               "call": {
                                                "func": "makeValueExpr",
                                                "arg": [
                                                 {
                                                  "literal": {
                                                   "s": "nil"
                                                  }
                                                 }
                                                ]
                                               }
                                              }
                                             ]
                                            }
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "let": {
                                        "name": "returnError",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "implFuncName"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Statement",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "implFuncName"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "ReturnStmt",
                                                  "expr": {
                                                   "transform": {
                                                    "arg": {
                                                     "name": "implFuncName"
                                                    },
                                                    "scopevar": ".",
                                                    "stmt": [
                                                     {
                                                      "assign": {
                                                       "name": "PayLoad",
                                                       "expr": {
                                                        "literal": {
                                                         "s": ""
                                                        }
                                                       }
                                                      }
                                                     }
                                                    ]
                                                   },
                                                   "type": {
                                                    "typeRef": {
                                                     "context": {
                                                      "appname": {
                                                       "part": [
                                                        "CodeGenTransform"
                                                       ]
                                                      }
                                                     },
                                                     "ref": {
                                                      "appname": {
                                                       "part": [
                                                        "ReturnStmt"
                                                       ]
                                                      }
                                                     }
                                                    }
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "Statement"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "StatementList"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "StatementList",
                                        "expr": {
                                         "list": {
                                          "expr": [
                                           {
                                            "name": "handleError"
                                           },
                                           {
                                            "name": "returnError"
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "Block"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "IfElseStmt"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "ctxVar",
                    "expr": {
                     "literal": {
                      "s": "ctx"
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "reqToCtx",
                    "expr": {
                     "literal": {
                      "s": "common.RequestHeaderToContext"
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "ctx",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ctxVar"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "let": {
                         "name": "reqCtx",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ctxVar"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ctxVar"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "DeclareAndAssignStmt",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ctxVar"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Variables",
                                        "expr": {
                                         "name": "ctxVar"
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "ctxVar"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "FunctionCall",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "reqToCtx"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "FunctionName",
                                                  "expr": {
                                                   "name": "reqToCtx"
                                                  }
                                                 }
                                                },
                                                {
                                                 "assign": {
                                                  "name": "FunctionArgs",
                                                  "expr": {
                                                   "transform": {
                                                    "arg": {
                                                     "name": "reqToCtx"
                                                    },
                                                    "scopevar": ".",
                                                    "stmt": [
                                                     {
                                                      "assign": {
                                                       "name": "Expression",
                                                       "expr": {
                                                        "call": {
                                                         "func": "makeValueExpr",
                                                         "arg": [
                                                          {
                                                           "literal": {
                                                            "s": "r.Context()"
                                                           }
                                                          }
                                                         ]
                                                        }
                                                       }
                                                      }
                                                     },
                                                     {
                                                      "assign": {
                                                       "name": "FuncArgsRest",
                                                       "expr": {
                                                        "transform": {
                                                         "arg": {
                                                          "list": {
                                                           "expr": [
                                                            {
                                                             "name": "reqToCtx"
                                                            }
                                                           ]
                                                          }
                                                         },
                                                         "scopevar": "a",
                                                         "stmt": [
                                                          {
                                                           "assign": {
                                                            "name": "Expression",
                                                            "expr": {
                                                             "call": {
                                                              "func": "makeValueExpr",
                                                              "arg": [
                                                               {
                                                                "literal": {
                                                                 "s": "r.Header"
                                                                }
                                                               }
                                                              ]
                                                             }
                                                            }
                                                           }
                                                          }
                                                         ]
                                                        },
                                                        "type": {
                                                         "sequence": {
                                                          "typeRef": {
                                                           "context": {
                                                            "appname": {
                                                             "part": [
                                                              "CodeGenTransform"
                                                             ]
                                                            },
                                                            "path": [
                                                             "EpHandlerMethodDecl"
                                                            ]
                                                           },
                                                           "ref": {
                                                            "path": [
                                                             "FuncArgsRest"
                                                            ]
                                                           }
                                                          }
                                                         }
                                                        }
                                                       }
                                                      }
                                                     }
                                                    ]
                                                   },
                                                   "type": {
                                                    "typeRef": {
                                                     "context": {
                                                      "appname": {
                                                       "part": [
                                                        "CodeGenTransform"
                                                       ]
                                                      }
                                                     },
                                                     "ref": {
                                                      "appname": {
                                                       "part": [
                                                        "FunctionArgs"
                                                       ]
                                                      }
                                                     }
                                                    }
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FunctionCall"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "Expression"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "DeclareAndAssignStmt"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "respToCtx",
                         "expr": {
                          "literal": {
                           "s": "common.RespHeaderAndStatusToContext"
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "respCtx",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ctxVar"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ctxVar"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "AssignStmt",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ctxVar"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Variables",
                                        "expr": {
                                         "name": "ctxVar"
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "ctxVar"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "FunctionCall",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "respToCtx"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "FunctionName",
                                                  "expr": {
                                                   "name": "respToCtx"
                                                  }
                                                 }
                                                },
                                                {
                                                 "assign": {
                                                  "name": "FunctionArgs",
                                                  "expr": {
                                                   "transform": {
                                                    "arg": {
                                                     "name": "respToCtx"
                                                    },
                                                    "scopevar": ".",
                                                    "stmt": [
                                                     {
                                                      "assign": {
                                                       "name": "Expression",
                                                       "expr": {
                                                        "call": {
                                                         "func": "makeValueExpr",
                                                         "arg": [
                                                          {
                                                           "name": "ctxVar"
                                                          }
                                                         ]
                                                        }
                                                       }
                                                      }
                                                     },
                                                     {
                                                      "assign": {
                                                       "name": "FuncArgsRest",
                                                       "expr": {
                                                        "transform": {
                                                         "arg": {
                                                          "list": {
                                                           "expr": [
                                                            {
                                                             "literal": {
                                                              "s": "make(http.Header)"
                                                             }
                                                            },
                                                            {
                                                             "literal": {
                                                              "s": "http.StatusOK"
                                                             }
                                                            }
                                                           ]
                                                          }
                                                         },
                                                         "scopevar": "a",
                                                         "stmt": [
                                                          {
                                                           "assign": {
                                                            "name": "Expression",
                                                            "expr": {
                                                             "call": {
                                                              "func": "makeValueExpr",
                                                              "arg": [
                                                               {
                                                                "name": "a"
                                                               }
                                                              ]
                                                             }
                                                            }
                                                           }
                                                          }
                                                         ]
                                                        },
                                                        "type": {
                                                         "sequence": {
                                                          "typeRef": {
                                                           "context": {
                                                            "appname": {
                                                             "part": [
                                                              "CodeGenTransform"
                                                             ]
                                                            },
                                                            "path": [
                                                             "EpHandlerMethodDecl"
                                                            ]
                                                           },
                                                           "ref": {
                                                            "path": [
                                                             "FuncArgsRest"
                                                            ]
                                                           }
                                                          }
                                                         }
                                                        }
                                                       }
                                                      }
                                                     }
                                                    ]
                                                   },
                                                   "type": {
                                                    "typeRef": {
                                                     "context": {
                                                      "appname": {
                                                       "part": [
                                                        "CodeGenTransform"
                                                       ]
                                                      }
                                                     },
                                                     "ref": {
                                                      "appname": {
                                                       "part": [
                                                        "FunctionArgs"
                                                       ]
                                                      }
                                                     }
                                                    }
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FunctionCall"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "Expression"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "AssignStmt"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "StatementList",
                         "expr": {
                          "list": {
                           "expr": [
                            {
                             "name": "reqCtx"
                            },
                            {
                             "name": "respCtx"
                            }
                           ]
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Block"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "declareClient",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "DeclareAndAssignStmt",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "Variables",
                                   "expr": {
                                    "literal": {
                                     "s": "client"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "Expression",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ep"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "NewStruct",
                                        "expr": {
                                         "call": {
                                          "func": "makeClient",
                                          "arg": [
                                           {
                                            "name": "app"
                                           },
                                           {
                                            "name": "ep"
                                           },
                                           {
                                            "name": "module"
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "Expression"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "DeclareAndAssignStmt"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "implCall",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "DeclareAndAssignStmt",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "Variables",
                                   "expr": {
                                    "name": "returnValues"
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "Expression",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ep"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "FunctionCall",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "ep"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "FunctionName",
                                             "expr": {
                                              "binexpr": {
                                               "op": "ADD",
                                               "lhs": {
                                                "literal": {
                                                 "s": "s.serviceInterface."
                                                }
                                               },
                                               "rhs": {
                                                "name": "implFuncName"
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "FunctionArgs",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "ep"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "literal": {
                                                       "s": "ctx"
                                                      }
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                },
                                                {
                                                 "assign": {
                                                  "name": "FuncArgsRest",
                                                  "expr": {
                                                   "transform": {
                                                    "arg": {
                                                     "list": {
                                                      "expr": [
                                                       {
                                                        "literal": {
                                                         "s": "\u0026req"
                                                        }
                                                       },
                                                       {
                                                        "literal": {
                                                         "s": "client"
                                                        }
                                                       }
                                                      ]
                                                     }
                                                    },
                                                    "scopevar": "p",
                                                    "stmt": [
                                                     {
                                                      "assign": {
                                                       "name": "Expression",
                                                       "expr": {
                                                        "call": {
                                                         "func": "makeValueExpr",
                                                         "arg": [
                                                          {
                                                           "name": "p"
                                                          }
                                                         ]
                                                        }
                                                       }
                                                      }
                                                     }
                                                    ]
                                                   },
                                                   "type": {
                                                    "sequence": {
                                                     "typeRef": {
                                                      "context": {
                                                       "appname": {
                                                        "part": [
                                                         "CodeGenTransform"
                                                        ]
                                                       },
                                                       "path": [
                                                        "EpHandlerMethodDecl"
                                                       ]
                                                      },
                                                      "ref": {
                                                       "path": [
                                                        "FuncArgsRest"
                                                       ]
                                                      }
                                                     }
                                                    }
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FunctionArgs"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "FunctionCall"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "Expression"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "DeclareAndAssignStmt"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "errCheckWithOutDB",
                    "expr": {
                     "call": {
                      "func": "handleError",
                      "arg": [
                       {
                        "literal": {
                         "s": "err != nil"
                        }
                       },
                       {
                        "literal": {
                         "s": "common.DownstreamUnexpectedResponseError"
                        }
                       },
                       {
                        "literal": {
                         "s": "\"Downstream failure\""
                        }
                       },
                       {
                        "literal": {
                         "s": "err"
                        }
                       }
                      ]
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "errCheckWithDB",
                    "expr": {
                     "call": {
                      "func": "handleErrorWithRollback",
                      "arg": [
                       {
                        "literal": {
                         "s": "err != nil"
                        }
                       },
                       {
                        "literal": {
                         "s": "common.DownstreamUnexpectedResponseError"
                        }
                       },
                       {
                        "literal": {
                         "s": "\"Downstream failure\""
                        }
                       },
                       {
                        "literal": {
                         "s": "err"
                        }
                       }
                      ]
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "errCheck",
                    "expr": {
                     "ifelse": {
                      "cond": {
                       "getAttr": {
                        "arg": {
                         "call": {
                          "func": "IsDataBaseApp",
                          "arg": [
                           {
                            "name": "app"
                           }
                          ]
                         }
                        },
                        "attr": "out"
                       }
                      },
                      "ifTrue": {
                       "name": "errCheckWithDB"
                      },
                      "ifFalse": {
                       "name": "errCheckWithOutDB"
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "transactionCommit",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "DeclareAndAssignStmt",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "Variables",
                                   "expr": {
                                    "literal": {
                                     "s": "commitErr"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "Expression",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ep"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "FunctionCall",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "ep"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "FunctionName",
                                             "expr": {
                                              "literal": {
                                               "s": "tx.Commit"
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "FunctionCall"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "Expression"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "DeclareAndAssignStmt"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "commitErrorHandle",
                    "expr": {
                     "call": {
                      "func": "handleError",
                      "arg": [
                       {
                        "binexpr": {
                         "op": "ADD",
                         "lhs": {
                          "literal": {
                           "s": "commitErr"
                          }
                         },
                         "rhs": {
                          "literal": {
                           "s": " != nil"
                          }
                         }
                        }
                       },
                       {
                        "literal": {
                         "s": "common.InternalError"
                        }
                       },
                       {
                        "literal": {
                         "s": "\"Failed to commit the transaction\""
                        }
                       },
                       {
                        "literal": {
                         "s": "commitErr"
                        }
                       }
                      ]
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "assignResp",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "DeclareAndAssignStmt",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "Variables",
                                   "expr": {
                                    "literal": {
                                     "s": "headermap, httpstatus"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "Expression",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ep"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "FunctionCall",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "ep"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "FunctionName",
                                             "expr": {
                                              "literal": {
                                               "s": "common.RespHeaderAndStatusFromContext"
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "FunctionArgs",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "ep"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "literal": {
                                                       "s": "ctx"
                                                      }
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FunctionArgs"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "FunctionCall"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "Expression"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "DeclareAndAssignStmt"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "setHeadersCall",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "literal": {
                                     "s": "restlib.SetHeaders"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "FunctionArgs",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ep"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "call": {
                                          "func": "makeValueExpr",
                                          "arg": [
                                           {
                                            "literal": {
                                             "s": "w"
                                            }
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "FuncArgsRest",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "list": {
                                            "expr": [
                                             {
                                              "name": "ep"
                                             }
                                            ]
                                           }
                                          },
                                          "scopevar": "a",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Expression",
                                             "expr": {
                                              "call": {
                                               "func": "makeValueExpr",
                                               "arg": [
                                                {
                                                 "literal": {
                                                  "s": "headermap"
                                                 }
                                                }
                                               ]
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "sequence": {
                                           "typeRef": {
                                            "context": {
                                             "appname": {
                                              "part": [
                                               "CodeGenTransform"
                                              ]
                                             },
                                             "path": [
                                              "EpHandlerMethodDecl"
                                             ]
                                            },
                                            "ref": {
                                             "path": [
                                              "FuncArgsRest"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionArgs"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "sendRespCall",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "literal": {
                                     "s": "restlib.SendHTTPResponse"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "FunctionArgs",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ep"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "call": {
                                          "func": "makeValueExpr",
                                          "arg": [
                                           {
                                            "literal": {
                                             "s": "w"
                                            }
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "FuncArgsRest",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "list": {
                                            "expr": [
                                             {
                                              "name": "ep"
                                             }
                                            ]
                                           }
                                          },
                                          "scopevar": "a",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Expression",
                                             "expr": {
                                              "call": {
                                               "func": "makeValueExpr",
                                               "arg": [
                                                {
                                                 "name": "sendRespCallArgs"
                                                }
                                               ]
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "sequence": {
                                           "typeRef": {
                                            "context": {
                                             "appname": {
                                              "part": [
                                               "CodeGenTransform"
                                              ]
                                             },
                                             "path": [
                                              "EpHandlerMethodDecl"
                                             ]
                                            },
                                            "ref": {
                                             "path": [
                                              "FuncArgsRest"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionArgs"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "withTimeout",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "DeclareAndAssignStmt",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "Variables",
                                   "expr": {
                                    "literal": {
                                     "s": "ctx, cancel"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "Expression",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "ep"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "FunctionCall",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "ep"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "FunctionName",
                                             "expr": {
                                              "literal": {
                                               "s": "s.genCallback.DownstreamTimeoutContext"
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "FunctionArgs",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "ep"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "transform": {
                                                    "arg": {
                                                     "name": "ep"
                                                    },
                                                    "scopevar": ".",
                                                    "stmt": [
                                                     {
                                                      "assign": {
                                                       "name": "ValueExpr",
                                                       "expr": {
                                                        "literal": {
                                                         "s": "ctx"
                                                        }
                                                       }
                                                      }
                                                     }
                                                    ]
                                                   },
                                                   "type": {
                                                    "typeRef": {
                                                     "context": {
                                                      "appname": {
                                                       "part": [
                                                        "CodeGenTransform"
                                                       ]
                                                      }
                                                     },
                                                     "ref": {
                                                      "appname": {
                                                       "part": [
                                                        "Expression"
                                                       ]
                                                      }
                                                     }
                                                    }
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FunctionArgs"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "FunctionCall"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "Expression"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "DeclareAndAssignStmt"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "deferCancel",
                    "expr": {
                     "literal": {
                      "s": "defer cancel"
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "cancel",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "deferCancel"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "deferCancel"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "deferCancel"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "name": "deferCancel"
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "requestDecl",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Statement",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "VarDecl",
                              "expr": {
                               "call": {
                                "func": "varDecl",
                                "arg": [
                                 {
                                  "literal": {
                                   "s": "req"
                                  }
                                 },
                                 {
                                  "binexpr": {
                                   "op": "ADD",
                                   "lhs": {
                                    "name": "implFuncName"
                                   },
                                   "rhs": {
                                    "literal": {
                                     "s": "Request"
                                    }
                                   }
                                  }
                                 }
                                ]
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Statement"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StatementList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "funcCallsWithDB",
                    "expr": {
                     "binexpr": {
                      "op": "BITOR",
                      "lhs": {
                       "binexpr": {
                        "op": "BITOR",
                        "lhs": {
                         "binexpr": {
                          "op": "BITOR",
                          "lhs": {
                           "list": {
                            "expr": [
                             {
                              "name": "withTimeout"
                             },
                             {
                              "name": "cancel"
                             }
                            ]
                           }
                          },
                          "rhs": {
                           "getAttr": {
                            "arg": {
                             "call": {
                              "func": "validateRequest",
                              "arg": [
                               {
                                "literal": {
                                 "s": "\u0026req"
                                }
                               }
                              ]
                             }
                            },
                            "attr": "StatementList"
                           }
                          }
                         }
                        },
                        "rhs": {
                         "getAttr": {
                          "arg": {
                           "call": {
                            "func": "retrieveDBHandle",
                            "arg": [
                             {
                              "name": "ep"
                             }
                            ]
                           }
                          },
                          "attr": "StatementList"
                         }
                        }
                       }
                      },
                      "rhs": {
                       "list": {
                        "expr": [
                         {
                          "name": "declareClient"
                         },
                         {
                          "name": "implCall"
                         },
                         {
                          "name": "errCheck"
                         },
                         {
                          "name": "transactionCommit"
                         },
                         {
                          "name": "commitErrorHandle"
                         },
                         {
                          "name": "assignResp"
                         },
                         {
                          "name": "setHeadersCall"
                         },
                         {
                          "name": "sendRespCall"
                         }
                        ]
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "funcCallsWithOutDB",
                    "expr": {
                     "binexpr": {
                      "op": "BITOR",
                      "lhs": {
                       "binexpr": {
                        "op": "BITOR",
                        "lhs": {
                         "list": {
                          "expr": [
                           {
                            "name": "withTimeout"
                           },
                           {
                            "name": "cancel"
                           }
                          ]
                         }
                        },
                        "rhs": {
                         "getAttr": {
                          "arg": {
                           "call": {
                            "func": "validateRequest",
                            "arg": [
                             {
                              "literal": {
                               "s": "\u0026req"
                              }
                             }
                            ]
                           }
                          },
                          "attr": "StatementList"
                         }
                        }
                       }
                      },
                      "rhs": {
                       "list": {
                        "expr": [
                         {
                          "name": "declareClient"
                         },
                         {
                          "name": "implCall"
                         },
                         {
                          "name": "errCheck"
                         },
                         {
                          "name": "assignResp"
                         },
                         {
                          "name": "setHeadersCall"
                         },
                         {
                          "name": "sendRespCall"
                         }
                        ]
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "funcCalls",
                    "expr": {
                     "ifelse": {
                      "cond": {
                       "getAttr": {
                        "arg": {
                         "call": {
                          "func": "IsDataBaseApp",
                          "arg": [
                           {
                            "name": "app"
                           }
                          ]
                         }
                        },
                        "attr": "out"
                       }
                      },
                      "ifTrue": {
                       "name": "funcCallsWithDB"
                      },
                      "ifFalse": {
                       "name": "funcCallsWithOutDB"
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "commonStmtList",
                    "expr": {
                     "binexpr": {
                      "op": "BITOR",
                      "lhs": {
                       "binexpr": {
                        "op": "BITOR",
                        "lhs": {
                         "list": {
                          "expr": [
                           {
                            "name": "requestDecl"
                           }
                          ]
                         }
                        },
                        "rhs": {
                         "getAttr": {
                          "arg": {
                           "call": {
                            "func": "getReqVars",
                            "arg": [
                             {
                              "name": "allParams"
                             }
                            ]
                           }
                          },
                          "attr": "StatementList"
                         }
                        }
                       }
                      },
                      "rhs": {
                       "call": {
                        "func": "validateHeaders",
                        "arg": [
                         {
                          "name": "ep"
                         }
                        ]
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "let": {
                    "name": "stmtList",
                    "expr": {
                     "name": "commonStmtList"
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "StatementList",
                    "expr": {
                     "ifelse": {
                      "cond": {
                       "binexpr": {
                        "op": "EQ",
                        "lhs": {
                         "getAttr": {
                          "arg": {
                           "getAttr": {
                            "arg": {
                             "name": "ep"
                            },
                            "attr": "value"
                           }
                          },
                          "attr": "method"
                         }
                        },
                        "rhs": {
                         "literal": {
                          "s": "GET"
                         }
                        }
                       }
                      },
                      "ifTrue": {
                       "binexpr": {
                        "op": "BITOR",
                        "lhs": {
                         "binexpr": {
                          "op": "BITOR",
                          "lhs": {
                           "binexpr": {
                            "op": "BITOR",
                            "lhs": {
                             "list": {
                              "expr": [
                               {
                                "name": "nilCheck"
                               }
                              ]
                             }
                            },
                            "rhs": {
                             "getAttr": {
                              "arg": {
                               "name": "ctx"
                              },
                              "attr": "StatementList"
                             }
                            }
                           }
                          },
                          "rhs": {
                           "name": "stmtList"
                          }
                         }
                        },
                        "rhs": {
                         "name": "funcCalls"
                        }
                       }
                      },
                      "ifFalse": {
                       "ifelse": {
                        "cond": {
                         "binexpr": {
                          "op": "EQ",
                          "lhs": {
                           "getAttr": {
                            "arg": {
                             "getAttr": {
                              "arg": {
                               "name": "ep"
                              },
                              "attr": "value"
                             }
                            },
                            "attr": "method"
                           }
                          },
                          "rhs": {
                           "literal": {
                            "s": "POST"
                           }
                          }
                         }
                        },
                        "ifTrue": {
                         "binexpr": {
                          "op": "BITOR",
                          "lhs": {
                           "binexpr": {
                            "op": "BITOR",
                            "lhs": {
                             "binexpr": {
                              "op": "BITOR",
                              "lhs": {
                               "binexpr": {
                                "op": "BITOR",
                                "lhs": {
                                 "list": {
                                  "expr": [
                                   {
                                    "name": "nilCheck"
                                   }
                                  ]
                                 }
                                },
                                "rhs": {
                                 "getAttr": {
                                  "arg": {
                                   "name": "ctx"
                                  },
                                  "attr": "StatementList"
                                 }
                                }
                               }
                              },
                              "rhs": {
                               "name": "stmtList"
                              }
                             }
                            },
                            "rhs": {
                             "getAttr": {
                              "arg": {
                               "call": {
                                "func": "getBodyParams",
                                "arg": [
                                 {
                                  "getAttr": {
                                   "arg": {
                                    "name": "allParams"
                                   },
                                   "attr": "BodyParams"
                                  }
                                 },
                                 {
                                  "name": "packageName"
                                 }
                                ]
                               }
                              },
                              "attr": "StatementList"
                             }
                            }
                           }
                          },
                          "rhs": {
                           "name": "funcCalls"
                          }
                         }
                        },
                        "ifFalse": {
                         "ifelse": {
                          "cond": {
                           "binexpr": {
                            "op": "EQ",
                            "lhs": {
                             "getAttr": {
                              "arg": {
                               "getAttr": {
                                "arg": {
                                 "name": "ep"
                                },
                                "attr": "value"
                               }
                              },
                              "attr": "method"
                             }
                            },
                            "rhs": {
                             "literal": {
                              "s": "PUT"
                             }
                            }
                           }
                          },
                          "ifTrue": {
                           "binexpr": {
                            "op": "BITOR",
                            "lhs": {
                             "binexpr": {
                              "op": "BITOR",
                              "lhs": {
                               "binexpr": {
                                "op": "BITOR",
                                "lhs": {
                                 "binexpr": {
                                  "op": "BITOR",
                                  "lhs": {
                                   "list": {
                                    "expr": [
                                     {
                                      "name": "nilCheck"
                                     }
                                    ]
                                   }
                                  },
                                  "rhs": {
                                   "getAttr": {
                                    "arg": {
                                     "name": "ctx"
                                    },
                                    "attr": "StatementList"
                                   }
                                  }
                                 }
                                },
                                "rhs": {
                                 "name": "stmtList"
                                }
                               }
                              },
                              "rhs": {
                               "getAttr": {
                                "arg": {
                                 "call": {
                                  "func": "getBodyParams",
                                  "arg": [
                                   {
                                    "getAttr": {
                                     "arg": {
                                      "name": "allParams"
                                     },
                                     "attr": "BodyParams"
                                    }
                                   },
                                   {
                                    "name": "packageName"
                                   }
                                  ]
                                 }
                                },
                                "attr": "StatementList"
                               }
                              }
                             }
                            },
                            "rhs": {
                             "name": "funcCalls"
                            }
                           }
                          },
                          "ifFalse": {
                           "ifelse": {
                            "cond": {
                             "binexpr": {
                              "op": "EQ",
                              "lhs": {
                               "getAttr": {
                                "arg": {
                                 "getAttr": {
                                  "arg": {
                                   "name": "ep"
                                  },
                                  "attr": "value"
                                 }
                                },
                                "attr": "method"
                               }
                              },
                              "rhs": {
                               "literal": {
                                "s": "DELETE"
                               }
                              }
                             }
                            },
                            "ifTrue": {
                             "binexpr": {
                              "op": "BITOR",
                              "lhs": {
                               "binexpr": {
                                "op": "BITOR",
                                "lhs": {
                                 "binexpr": {
                                  "op": "BITOR",
                                  "lhs": {
                                   "list": {
                                    "expr": [
                                     {
                                      "name": "nilCheck"
                                     }
                                    ]
                                   }
                                  },
                                  "rhs": {
                                   "getAttr": {
                                    "arg": {
                                     "name": "ctx"
                                    },
                                    "attr": "StatementList"
                                   }
                                  }
                                 }
                                },
                                "rhs": {
                                 "name": "stmtList"
                                }
                               }
                              },
                              "rhs": {
                               "name": "funcCalls"
                              }
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Block"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "MethodDecl"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 650,
       "col": 2
      }
     }
    },
    "GoName": {
     "param": [
      {
       "name": "word",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "word"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "splitted",
          "expr": {
           "ifelse": {
            "cond": {
             "call": {
              "func": "MatchString",
              "arg": [
               {
                "literal": {
                 "s": "^[\\p{L}_][\\p{L}\\p{N}_]*$"
                }
               },
               {
                "name": "word"
               }
              ]
             }
            },
            "ifTrue": {
             "list": {
              "expr": [
               {
                "name": "word"
               }
              ]
             }
            },
            "ifFalse": {
             "call": {
              "func": "FindAllString",
              "arg": [
               {
                "literal": {
                 "s": "[\\p{L}_][\\p{L}\\p{N}_]*"
                }
               },
               {
                "name": "word"
               },
               {
                "unexpr": {
                 "op": "NEG",
                 "arg": {
                  "literal": {
                   "i": "1"
                  }
                 }
                }
               }
              ]
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "initialisms",
          "expr": {
           "list": {
            "expr": [
             {
              "literal": {
               "s": "ACL"
              }
             },
             {
              "literal": {
               "s": "API"
              }
             },
             {
              "literal": {
               "s": "ASCII"
              }
             },
             {
              "literal": {
               "s": "CPU"
              }
             },
             {
              "literal": {
               "s": "CSS"
              }
             },
             {
              "literal": {
               "s": "DNS"
              }
             },
             {
              "literal": {
               "s": "EOF"
              }
             },
             {
              "literal": {
               "s": "GUID"
              }
             },
             {
              "literal": {
               "s": "HTML"
              }
             },
             {
              "literal": {
               "s": "HTTP"
              }
             },
             {
              "literal": {
               "s": "HTTPS"
              }
             },
             {
              "literal": {
               "s": "ID"
              }
             },
             {
              "literal": {
               "s": "IP"
              }
             },
             {
              "literal": {
               "s": "JSON"
              }
             },
             {
              "literal": {
               "s": "LHS"
              }
             },
             {
              "literal": {
               "s": "QPS"
              }
             },
             {
              "literal": {
               "s": "RAM"
              }
             },
             {
              "literal": {
               "s": "RHS"
              }
             },
             {
              "literal": {
               "s": "RPC"
              }
             },
             {
              "literal": {
               "s": "SLA"
              }
             },
             {
              "literal": {
               "s": "SMTP"
              }
             },
             {
              "literal": {
               "s": "SQL"
              }
             },
             {
              "literal": {
               "s": "SSH"
              }
             },
             {
              "literal": {
               "s": "TCP"
              }
             },
             {
              "literal": {
               "s": "TLS"
              }
             },
             {
              "literal": {
               "s": "TTL"
              }
             },
             {
              "literal": {
               "s": "UDP"
              }
             },
             {
              "literal": {
               "s": "UI"
              }
             },
             {
              "literal": {
               "s": "UID"
              }
             },
             {
              "literal": {
               "s": "UUID"
              }
             },
             {
              "literal": {
               "s": "URI"
              }
             },
             {
              "literal": {
               "s": "URL"
              }
             },
             {
              "literal": {
               "s": "UTF8"
              }
             },
             {
              "literal": {
               "s": "VM"
              }
             },
             {
              "literal": {
               "s": "XML"
              }
             },
             {
              "literal": {
               "s": "XMPP"
              }
             },
             {
              "literal": {
               "s": "XSRF"
              }
             },
             {
              "literal": {
               "s": "XSS"
              }
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "wordUpper",
          "expr": {
           "transform": {
            "arg": {
             "name": "splitted"
            },
            "scopevar": "w",
            "stmt": [
             {
              "let": {
               "name": "upper",
               "expr": {
                "call": {
                 "func": "ToTitle",
                 "arg": [
                  {
                   "call": {
                    "func": "TrimPrefix",
                    "arg": [
                     {
                      "name": "w"
                     },
                     {
                      "literal": {
                       "s": "_"
                      }
                     }
                    ]
                   }
                  }
                 ]
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "ifelse": {
                 "cond": {
                  "binexpr": {
                   "op": "IN",
                   "lhs": {
                    "name": "upper"
                   },
                   "rhs": {
                    "name": "initialisms"
                   }
                  }
                 },
                 "ifTrue": {
                  "name": "upper"
                 },
                 "ifFalse": {
                  "call": {
                   "func": "Title",
                   "arg": [
                    {
                     "name": "w"
                    }
                   ]
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "primitive": "STRING",
             "constraint": [
             ]
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "call": {
            "func": "Join",
            "arg": [
             {
              "binexpr": {
               "op": "FLATTEN",
               "lhs": {
                "name": "wordUpper"
               },
               "rhs": {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "out"
                }
               },
               "scopevar": "."
              }
             },
             {
              "literal": {
               "s": ""
              }
             }
            ]
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 2,
       "col": 2
      }
     }
    },
    "IsDataBaseApp": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "app"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "Patterns",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "AND",
              "lhs": {
               "binexpr": {
                "op": "GT",
                "lhs": {
                 "call": {
                  "func": ".count",
                  "arg": [
                   {
                    "getAttr": {
                     "arg": {
                      "name": "app"
                     },
                     "attr": "attrs"
                    }
                   }
                  ]
                 }
                },
                "rhs": {
                 "literal": {
                  "i": "0"
                 }
                }
               }
              },
              "rhs": {
               "binexpr": {
                "op": "IN",
                "lhs": {
                 "literal": {
                  "s": "patterns"
                 }
                },
                "rhs": {
                 "getAttr": {
                  "arg": {
                   "name": "app"
                  },
                  "attr": "attrs"
                 }
                }
               }
              }
             }
            },
            "ifTrue": {
             "getAttr": {
              "arg": {
               "getAttr": {
                "arg": {
                 "name": "app"
                },
                "attr": "attrs"
               }
              },
              "attr": "patterns"
             }
            },
            "ifFalse": {
             "list": {
              "expr": [
               {
                "literal": {
                 "s": ""
                }
               }
              ]
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "IN",
              "lhs": {
               "literal": {
                "s": "DB"
               }
              },
              "rhs": {
               "name": "Patterns"
              }
             }
            },
            "ifTrue": {
             "literal": {
              "b": true
             },
             "type": {
              "primitive": "BOOL"
             }
            },
            "ifFalse": {
             "literal": {
              "b": false
             },
             "type": {
              "primitive": "BOOL"
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 1155,
       "col": 2
      }
     }
    },
    "ParamType": {
     "param": [
      {
       "name": "t",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Type"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "t"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "IsPtr",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "AND",
              "lhs": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "t"
                  },
                  "attr": "optional"
                 }
                },
                "rhs": {
                 "literal": {
                  "b": true
                 },
                 "type": {
                  "primitive": "BOOL"
                 }
                }
               }
              },
              "rhs": {
               "binexpr": {
                "op": "NE",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "t"
                  },
                  "attr": "type"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "sequence"
                 }
                }
               }
              }
             }
            },
            "ifTrue": {
             "literal": {
              "s": "*"
             }
            },
            "ifFalse": {
             "literal": {
              "s": ""
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "typeName",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "EQ",
              "lhs": {
               "getAttr": {
                "arg": {
                 "name": "t"
                },
                "attr": "type"
               }
              },
              "rhs": {
               "literal": {
                "s": "primitive"
               }
              }
             }
            },
            "ifTrue": {
             "ifelse": {
              "cond": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "t"
                  },
                  "attr": "primitive"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "DECIMAL"
                 }
                }
               }
              },
              "ifTrue": {
               "literal": {
                "s": "double"
               }
              },
              "ifFalse": {
               "ifelse": {
                "cond": {
                 "binexpr": {
                  "op": "EQ",
                  "lhs": {
                   "getAttr": {
                    "arg": {
                     "name": "t"
                    },
                    "attr": "primitive"
                   }
                  },
                  "rhs": {
                   "literal": {
                    "s": "INT"
                   }
                  }
                 }
                },
                "ifTrue": {
                 "literal": {
                  "s": "int64"
                 }
                },
                "ifFalse": {
                 "ifelse": {
                  "cond": {
                   "binexpr": {
                    "op": "EQ",
                    "lhs": {
                     "getAttr": {
                      "arg": {
                       "name": "t"
                      },
                      "attr": "primitive"
                     }
                    },
                    "rhs": {
                     "literal": {
                      "s": "FLOAT"
                     }
                    }
                   }
                  },
                  "ifTrue": {
                   "literal": {
                    "s": "float64"
                   }
                  },
                  "ifFalse": {
                   "ifelse": {
                    "cond": {
                     "binexpr": {
                      "op": "EQ",
                      "lhs": {
                       "getAttr": {
                        "arg": {
                         "name": "t"
                        },
                        "attr": "primitive"
                       }
                      },
                      "rhs": {
                       "literal": {
                        "s": "STRING"
                       }
                      }
                     }
                    },
                    "ifTrue": {
                     "literal": {
                      "s": "string"
                     }
                    },
                    "ifFalse": {
                     "ifelse": {
                      "cond": {
                       "binexpr": {
                        "op": "EQ",
                        "lhs": {
                         "getAttr": {
                          "arg": {
                           "name": "t"
                          },
                          "attr": "primitive"
                         }
                        },
                        "rhs": {
                         "literal": {
                          "s": "STRING_8"
                         }
                        }
                       }
                      },
                      "ifTrue": {
                       "literal": {
                        "s": "string"
                       }
                      },
                      "ifFalse": {
                       "ifelse": {
                        "cond": {
                         "binexpr": {
                          "op": "EQ",
                          "lhs": {
                           "getAttr": {
                            "arg": {
                             "name": "t"
                            },
                            "attr": "primitive"
                           }
                          },
                          "rhs": {
                           "literal": {
                            "s": "BOOL"
                           }
                          }
                         }
                        },
                        "ifTrue": {
                         "literal": {
                          "s": "bool"
                         }
                        },
                        "ifFalse": {
                         "ifelse": {
                          "cond": {
                           "binexpr": {
                            "op": "EQ",
                            "lhs": {
                             "getAttr": {
                              "arg": {
                               "name": "t"
                              },
                              "attr": "primitive"
                             }
                            },
                            "rhs": {
                             "literal": {
                              "s": "DATE"
                             }
                            }
                           }
                          },
                          "ifTrue": {
                           "literal": {
                            "s": "date.Date"
                           }
                          },
                          "ifFalse": {
                           "ifelse": {
                            "cond": {
                             "binexpr": {
                              "op": "EQ",
                              "lhs": {
                               "getAttr": {
                                "arg": {
                                 "name": "t"
                                },
                                "attr": "primitive"
                               }
                              },
                              "rhs": {
                               "literal": {
                                "s": "DATETIME"
                               }
                              }
                             }
                            },
                            "ifTrue": {
                             "literal": {
                              "s": "convert.JSONTime"
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 }
                }
               }
              }
             }
            },
            "ifFalse": {
             "ifelse": {
              "cond": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "t"
                  },
                  "attr": "type"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "sequence"
                 }
                }
               }
              },
              "ifTrue": {
               "binexpr": {
                "op": "ADD",
                "lhs": {
                 "literal": {
                  "s": "[]"
                 }
                },
                "rhs": {
                 "getAttr": {
                  "arg": {
                   "call": {
                    "func": "GoType",
                    "arg": [
                     {
                      "getAttr": {
                       "arg": {
                        "name": "t"
                       },
                       "attr": "sequence"
                      }
                     }
                    ]
                   }
                  },
                  "attr": "out"
                 }
                }
               }
              },
              "ifFalse": {
               "getAttr": {
                "arg": {
                 "call": {
                  "func": "GoName",
                  "arg": [
                   {
                    "getAttr": {
                     "arg": {
                      "name": "t"
                     },
                     "attr": "type_ref"
                    }
                   }
                  ]
                 }
                },
                "attr": "out"
               }
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "binexpr": {
            "op": "ADD",
            "lhs": {
             "name": "IsPtr"
            },
            "rhs": {
             "name": "typeName"
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 16,
       "col": 2
      }
     }
    },
    "SetQueryAttributes": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "tn",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "name": "ep"
                },
                "attr": "attrs"
               }
              },
              "rhs": {
               "call": {
                "func": "HasPrefix",
                "arg": [
                 {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "key"
                  }
                 },
                 {
                  "literal": {
                   "s": "sql_"
                  }
                 }
                ]
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "t",
            "stmt": [
             {
              "assign": {
               "name": "out",
               "expr": {
                "transform": {
                 "arg": {
                  "literal": {
                   "s": "out"
                  }
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "identifier",
                    "expr": {
                     "call": {
                      "func": "ToLower",
                      "arg": [
                       {
                        "call": {
                         "func": "TrimPrefix",
                         "arg": [
                          {
                           "getAttr": {
                            "arg": {
                             "name": "t"
                            },
                            "attr": "key"
                           }
                          },
                          {
                           "literal": {
                            "s": "sql_"
                           }
                          }
                         ]
                        }
                       }
                      ]
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Expression",
                    "expr": {
                     "transform": {
                      "arg": {
                       "literal": {
                        "s": "Expr"
                       }
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "ValueExpr",
                         "expr": {
                          "binexpr": {
                           "op": "ADD",
                           "lhs": {
                            "call": {
                             "func": "ToLower",
                             "arg": [
                              {
                               "call": {
                                "func": "TrimPrefix",
                                "arg": [
                                 {
                                  "getAttr": {
                                   "arg": {
                                    "name": "t"
                                   },
                                   "attr": "key"
                                  }
                                 },
                                 {
                                  "literal": {
                                   "s": "sql_"
                                  }
                                 }
                                ]
                               }
                              }
                             ]
                            }
                           },
                           "rhs": {
                            "literal": {
                             "s": "Stmt"
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Expression"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "out"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "primitive": "STRING",
             "constraint": [
             ]
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "binexpr": {
            "op": "FLATTEN",
            "lhs": {
             "name": "tn"
            },
            "rhs": {
             "getAttr": {
              "arg": {
               "name": "."
              },
              "attr": "out"
             }
            },
            "scopevar": "."
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 1160,
       "col": 2
      }
     }
    },
    "VarName": {
     "param": [
      {
       "name": "word",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "word"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "out",
          "expr": {
           "call": {
            "func": "ToLower",
            "arg": [
             {
              "call": {
               "func": "Join",
               "arg": [
                {
                 "call": {
                  "func": "Split",
                  "arg": [
                   {
                    "name": "word"
                   },
                   {
                    "literal": {
                     "s": "_"
                    }
                   }
                  ]
                 }
                },
                {
                 "literal": {
                  "s": ""
                 }
                }
               ]
              }
             }
            ]
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 555,
       "col": 2
      }
     }
    },
    "declareHeaders": {
     "param": [
      {
       "name": "variableName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "typeName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "values",
       "type": {
        "sequence": {
         "primitive": "STRING",
         "constraint": [
         ]
        }
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "typeName"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "typeName"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "DeclareAndAssignStmt",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "typeName"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "Variables",
                    "expr": {
                     "name": "variableName"
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Expression",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "typeName"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "NewSlice",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "typeName"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "TypeName",
                              "expr": {
                               "name": "typeName"
                              }
                             }
                            },
                            {
                             "let": {
                              "name": "v",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "values"
                                },
                                "scopevar": "vv",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "out",
                                   "expr": {
                                    "binexpr": {
                                     "op": "ADD",
                                     "lhs": {
                                      "binexpr": {
                                       "op": "ADD",
                                       "lhs": {
                                        "literal": {
                                         "s": "\""
                                        }
                                       },
                                       "rhs": {
                                        "name": "vv"
                                       }
                                      }
                                     },
                                     "rhs": {
                                      "literal": {
                                       "s": "\""
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "sequence": {
                                 "primitive": "STRING",
                                 "constraint": [
                                 ]
                                }
                               }
                              }
                             }
                            },
                            {
                             "assign": {
                              "name": "SliceValues",
                              "expr": {
                               "call": {
                                "func": "Join",
                                "arg": [
                                 {
                                  "binexpr": {
                                   "op": "FLATTEN",
                                   "lhs": {
                                    "name": "v"
                                   },
                                   "rhs": {
                                    "getAttr": {
                                     "arg": {
                                      "name": "."
                                     },
                                     "attr": "out"
                                    }
                                   },
                                   "scopevar": "."
                                  }
                                 },
                                 {
                                  "literal": {
                                   "s": ","
                                  }
                                 }
                                ]
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "NewSlice"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Expression"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "DeclareAndAssignStmt"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 488,
       "col": 2
      }
     }
    },
    "epHandlerMethodSpecs": {
     "param": [
      {
       "name": "eps",
       "type": {
        "sequence": {
         "typeRef": {
          "context": {
           "appname": {
            "part": [
             "CodeGenTransform"
            ]
           },
           "path": [
            "epHandlerMethodSpecs"
           ]
          },
          "ref": {
           "appname": {
            "part": [
             "sysl"
            ]
           },
           "path": [
            "Endpoints"
           ]
          }
         }
        }
       }
      }
     ],
     "retType": {
      "sequence": {
       "typeRef": {
        "context": {
         "appname": {
          "part": [
           "CodeGenTransform"
          ]
         },
         "path": [
          "epHandlerMethodSpecs"
         ]
        },
        "ref": {
         "path": [
          "MethodSpec"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "binexpr": {
         "op": "WHERE",
         "lhs": {
          "name": "eps"
         },
         "rhs": {
          "binexpr": {
           "op": "EQ",
           "lhs": {
            "getAttr": {
             "arg": {
              "getAttr": {
               "arg": {
                "name": "."
               },
               "attr": "value"
              }
             },
             "attr": "is_rest"
            }
           },
           "rhs": {
            "literal": {
             "b": true
            },
            "type": {
             "primitive": "BOOL"
            }
           }
          }
         },
         "scopevar": "."
        }
       },
       "scopevar": "ep",
       "stmt": [
        {
         "assign": {
          "name": "MethodName",
          "expr": {
           "binexpr": {
            "op": "ADD",
            "lhs": {
             "getAttr": {
              "arg": {
               "call": {
                "func": "methodDef",
                "arg": [
                 {
                  "name": "ep"
                 }
                ]
               }
              },
              "attr": "methodName"
             }
            },
            "rhs": {
             "literal": {
              "s": "Handler"
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "Signature",
          "expr": {
           "transform": {
            "arg": {
             "name": "ep"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Parameters",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "ep"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "ParameterList",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "ParameterDecl",
                         "expr": {
                          "call": {
                           "func": "paramDecl",
                           "arg": [
                            {
                             "literal": {
                              "s": "w"
                             }
                            },
                            {
                             "literal": {
                              "s": "http.ResponseWriter"
                             }
                            }
                           ]
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "ParameterDeclC",
                         "expr": {
                          "transform": {
                           "arg": {
                            "list": {
                             "expr": [
                              {
                               "name": "ep"
                              }
                             ]
                            }
                           },
                           "scopevar": "ep",
                           "stmt": [
                            {
                             "assign": {
                              "name": "ParameterDecl",
                              "expr": {
                               "call": {
                                "func": "paramDecl",
                                "arg": [
                                 {
                                  "literal": {
                                   "s": "r"
                                  }
                                 },
                                 {
                                  "literal": {
                                   "s": "*http.Request"
                                  }
                                 }
                                ]
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "sequence": {
                            "typeRef": {
                             "context": {
                              "appname": {
                               "part": [
                                "CodeGenTransform"
                               ]
                              },
                              "path": [
                               "epHandlerMethodSpecs"
                              ]
                             },
                             "ref": {
                              "path": [
                               "ParameterDeclC"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "ParameterList"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Parameters"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Signature"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 367,
       "col": 2
      }
     }
    },
    "filename": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "app"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "filename",
          "expr": {
           "literal": {
            "s": "servicehandler.go"
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 34,
       "col": 2
      }
     }
    },
    "getAllParams": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "AllParams"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "reqQueryParams",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "queryvars"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "optional"
                 }
                },
                "rhs": {
                 "literal": {
                  "b": false
                 },
                 "type": {
                  "primitive": "BOOL"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "paramType",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "ParamType",
                   "arg": [
                    {
                     "name": "."
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramName",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "queryParamName",
                   "arg": [
                    {
                     "name": "ep"
                    },
                    {
                     "name": "."
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "varName",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "literal": {
                   "s": "req."
                  }
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "call": {
                     "func": "GoName",
                     "arg": [
                      {
                       "getAttr": {
                        "arg": {
                         "name": "."
                        },
                        "attr": "name"
                       }
                      }
                     ]
                    }
                   },
                   "attr": "out"
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "QueryParams"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "optQueryParams",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "queryvars"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "optional"
                 }
                },
                "rhs": {
                 "literal": {
                  "b": true
                 },
                 "type": {
                  "primitive": "BOOL"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "paramType",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "ParamType",
                   "arg": [
                    {
                     "name": "."
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramName",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "queryParamName",
                   "arg": [
                    {
                     "name": "ep"
                    },
                    {
                     "name": "."
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "varName",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "literal": {
                   "s": "req."
                  }
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "call": {
                     "func": "GoName",
                     "arg": [
                      {
                       "getAttr": {
                        "arg": {
                         "name": "."
                        },
                        "attr": "name"
                       }
                      }
                     ]
                    }
                   },
                   "attr": "out"
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "varNameClean",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "GoName",
                   "arg": [
                    {
                     "getAttr": {
                      "arg": {
                       "name": "."
                      },
                      "attr": "name"
                     }
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "QueryParams"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "pathParams",
          "expr": {
           "transform": {
            "arg": {
             "getAttr": {
              "arg": {
               "getAttr": {
                "arg": {
                 "name": "ep"
                },
                "attr": "value"
               }
              },
              "attr": "pathvars"
             }
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "paramType",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "ParamType",
                   "arg": [
                    {
                     "name": "."
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramName",
               "expr": {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "name"
                }
               }
              }
             },
             {
              "assign": {
               "name": "varName",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "literal": {
                   "s": "req."
                  }
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "call": {
                     "func": "GoName",
                     "arg": [
                      {
                       "getAttr": {
                        "arg": {
                         "name": "."
                        },
                        "attr": "name"
                       }
                      }
                     ]
                    }
                   },
                   "attr": "out"
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "PathParams"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "reqHeaderParams",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "params"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "AND",
                "lhs": {
                 "binexpr": {
                  "op": "IN",
                  "lhs": {
                   "literal": {
                    "s": "header"
                   }
                  },
                  "rhs": {
                   "getAttr": {
                    "arg": {
                     "getAttr": {
                      "arg": {
                       "name": "."
                      },
                      "attr": "attrs"
                     }
                    },
                    "attr": "patterns"
                   }
                  }
                 }
                },
                "rhs": {
                 "binexpr": {
                  "op": "IN",
                  "lhs": {
                   "literal": {
                    "s": "required"
                   }
                  },
                  "rhs": {
                   "getAttr": {
                    "arg": {
                     "getAttr": {
                      "arg": {
                       "name": "."
                      },
                      "attr": "attrs"
                     }
                    },
                    "attr": "patterns"
                   }
                  }
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "paramType",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "ParamType",
                   "arg": [
                    {
                     "name": "."
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramName",
               "expr": {
                "getAttr": {
                 "arg": {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "attrs"
                  }
                 },
                 "attr": "name"
                }
               }
              }
             },
             {
              "assign": {
               "name": "varName",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "GoName",
                   "arg": [
                    {
                     "getAttr": {
                      "arg": {
                       "getAttr": {
                        "arg": {
                         "name": "."
                        },
                        "attr": "attrs"
                       }
                      },
                      "attr": "name"
                     }
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "isOptional",
               "expr": {
                "literal": {
                 "b": false
                },
                "type": {
                 "primitive": "BOOL"
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "HeaderParams"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "optHeaderParams",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "params"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "AND",
                "lhs": {
                 "binexpr": {
                  "op": "IN",
                  "lhs": {
                   "literal": {
                    "s": "header"
                   }
                  },
                  "rhs": {
                   "getAttr": {
                    "arg": {
                     "getAttr": {
                      "arg": {
                       "name": "."
                      },
                      "attr": "attrs"
                     }
                    },
                    "attr": "patterns"
                   }
                  }
                 }
                },
                "rhs": {
                 "binexpr": {
                  "op": "IN",
                  "lhs": {
                   "literal": {
                    "s": "optional"
                   }
                  },
                  "rhs": {
                   "getAttr": {
                    "arg": {
                     "getAttr": {
                      "arg": {
                       "name": "."
                      },
                      "attr": "attrs"
                     }
                    },
                    "attr": "patterns"
                   }
                  }
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "paramType",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "ParamType",
                   "arg": [
                    {
                     "name": "."
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramName",
               "expr": {
                "getAttr": {
                 "arg": {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "attrs"
                  }
                 },
                 "attr": "name"
                }
               }
              }
             },
             {
              "assign": {
               "name": "varName",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "literal": {
                   "s": "req."
                  }
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "call": {
                     "func": "GoName",
                     "arg": [
                      {
                       "getAttr": {
                        "arg": {
                         "getAttr": {
                          "arg": {
                           "name": "."
                          },
                          "attr": "attrs"
                         }
                        },
                        "attr": "name"
                       }
                      }
                     ]
                    }
                   },
                   "attr": "out"
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "isOptional",
               "expr": {
                "literal": {
                 "b": true
                },
                "type": {
                 "primitive": "BOOL"
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "HeaderParams"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "bodyParams",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "params"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "IN",
                "lhs": {
                 "literal": {
                  "s": "body"
                 }
                },
                "rhs": {
                 "getAttr": {
                  "arg": {
                   "getAttr": {
                    "arg": {
                     "name": "."
                    },
                    "attr": "attrs"
                   }
                  },
                  "attr": "patterns"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": ".",
            "stmt": [
             {
              "let": {
               "name": "p",
               "expr": {
                "call": {
                 "func": "getPackagePrefix",
                 "arg": [
                  {
                   "getAttr": {
                    "arg": {
                     "name": "."
                    },
                    "attr": "type_ref"
                   }
                  },
                  {
                   "name": "module"
                  }
                 ]
                }
               }
              }
             },
             {
              "let": {
               "name": "t",
               "expr": {
                "call": {
                 "func": "TrimPrefix",
                 "arg": [
                  {
                   "getAttr": {
                    "arg": {
                     "name": "."
                    },
                    "attr": "type_ref"
                   }
                  },
                  {
                   "getAttr": {
                    "arg": {
                     "name": "p"
                    },
                    "attr": "appName"
                   }
                  }
                 ]
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramType",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "getAttr": {
                   "arg": {
                    "name": "p"
                   },
                   "attr": "out"
                  }
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "call": {
                     "func": "GoName",
                     "arg": [
                      {
                       "name": "t"
                      }
                     ]
                    }
                   },
                   "attr": "out"
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramName",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "GoName",
                   "arg": [
                    {
                     "getAttr": {
                      "arg": {
                       "name": "."
                      },
                      "attr": "name"
                     }
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             },
             {
              "assign": {
               "name": "varName",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "literal": {
                   "s": "req."
                  }
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "call": {
                     "func": "GoName",
                     "arg": [
                      {
                       "getAttr": {
                        "arg": {
                         "name": "."
                        },
                        "attr": "name"
                       }
                      }
                     ]
                    }
                   },
                   "attr": "out"
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "BodyParams"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "QueryParams",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "name": "reqQueryParams"
            },
            "rhs": {
             "name": "optQueryParams"
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "ReqQueryParams",
          "expr": {
           "name": "reqQueryParams"
          }
         }
        },
        {
         "assign": {
          "name": "OptQueryParams",
          "expr": {
           "name": "optQueryParams"
          }
         }
        },
        {
         "assign": {
          "name": "PathParams",
          "expr": {
           "name": "pathParams"
          }
         }
        },
        {
         "assign": {
          "name": "ReqHeaderParams",
          "expr": {
           "name": "reqHeaderParams"
          }
         }
        },
        {
         "assign": {
          "name": "OptHeaderParams",
          "expr": {
           "name": "optHeaderParams"
          }
         }
        },
        {
         "assign": {
          "name": "HeaderParams",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "name": "reqHeaderParams"
            },
            "rhs": {
             "name": "optHeaderParams"
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "BodyParams",
          "expr": {
           "name": "bodyParams"
          }
         }
        },
        {
         "assign": {
          "name": "AllParams",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "binexpr": {
              "op": "BITOR",
              "lhs": {
               "binexpr": {
                "op": "BITOR",
                "lhs": {
                 "binexpr": {
                  "op": "BITOR",
                  "lhs": {
                   "binexpr": {
                    "op": "BITOR",
                    "lhs": {
                     "binexpr": {
                      "op": "FLATTEN",
                      "lhs": {
                       "name": "pathParams"
                      },
                      "rhs": {
                       "getAttr": {
                        "arg": {
                         "name": "."
                        },
                        "attr": "paramName"
                       }
                      },
                      "scopevar": "."
                     }
                    },
                    "rhs": {
                     "binexpr": {
                      "op": "FLATTEN",
                      "lhs": {
                       "name": "reqQueryParams"
                      },
                      "rhs": {
                       "getAttr": {
                        "arg": {
                         "name": "."
                        },
                        "attr": "paramName"
                       }
                      },
                      "scopevar": "."
                     }
                    }
                   }
                  },
                  "rhs": {
                   "binexpr": {
                    "op": "FLATTEN",
                    "lhs": {
                     "name": "optQueryParams"
                    },
                    "rhs": {
                     "getAttr": {
                      "arg": {
                       "name": "."
                      },
                      "attr": "paramName"
                     }
                    },
                    "scopevar": "."
                   }
                  }
                 }
                },
                "rhs": {
                 "binexpr": {
                  "op": "FLATTEN",
                  "lhs": {
                   "name": "reqHeaderParams"
                  },
                  "rhs": {
                   "getAttr": {
                    "arg": {
                     "name": "."
                    },
                    "attr": "paramName"
                   }
                  },
                  "scopevar": "."
                 }
                }
               }
              },
              "rhs": {
               "binexpr": {
                "op": "FLATTEN",
                "lhs": {
                 "name": "optHeaderParams"
                },
                "rhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "paramName"
                 }
                },
                "scopevar": "."
               }
              }
             }
            },
            "rhs": {
             "binexpr": {
              "op": "FLATTEN",
              "lhs": {
               "name": "bodyParams"
              },
              "rhs": {
               "getAttr": {
                "arg": {
                 "name": "."
                },
                "attr": "paramName"
               }
              },
              "scopevar": "."
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 560,
       "col": 2
      }
     }
    },
    "getBodyParams": {
     "param": [
      {
       "name": "bodyParams",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "BodyParams"
           ]
          }
         }
        }
       }
      },
      {
       "name": "packageName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Block"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "packageName"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "decoder",
          "expr": {
           "call": {
            "func": "jsonDecoder",
            "arg": [
             {
              "literal": {
               "s": "decoder"
              }
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "structVarDecl",
          "expr": {
           "call": {
            "func": "structVarDecl",
            "arg": [
             {
              "name": "bodyParams"
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "jsonDecode",
          "expr": {
           "getAttr": {
            "arg": {
             "call": {
              "func": "jsonDecode",
              "arg": [
               {
                "name": "bodyParams"
               },
               {
                "name": "packageName"
               }
              ]
             }
            },
            "attr": "StatementList"
           }
          }
         }
        },
        {
         "assign": {
          "name": "StatementList",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "GT",
              "lhs": {
               "call": {
                "func": ".count",
                "arg": [
                 {
                  "name": "bodyParams"
                 }
                ]
               }
              },
              "rhs": {
               "literal": {
                "i": "0"
               }
              }
             }
            },
            "ifTrue": {
             "binexpr": {
              "op": "BITOR",
              "lhs": {
               "list": {
                "expr": [
                 {
                  "name": "decoder"
                 }
                ]
               }
              },
              "rhs": {
               "name": "jsonDecode"
              }
             }
            },
            "ifFalse": {
             "name": "structVarDecl"
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 515,
       "col": 2
      }
     }
    },
    "getOptParamStatements": {
     "param": [
      {
       "name": "paramList",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "ParamList"
           ]
          }
         }
        }
       }
      },
      {
       "name": "methodName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Block"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "methodName"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "paramSuffix",
          "expr": {
           "transform": {
            "arg": {
             "name": "paramList"
            },
            "scopevar": "p",
            "stmt": [
             {
              "assign": {
               "name": "varName",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "getAttr": {
                   "arg": {
                    "name": "p"
                   },
                   "attr": "varNameClean"
                  }
                 },
                 "rhs": {
                  "literal": {
                   "s": "Param"
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramName",
               "expr": {
                "getAttr": {
                 "arg": {
                  "name": "p"
                 },
                 "attr": "paramName"
                }
               }
              }
             },
             {
              "assign": {
               "name": "paramType",
               "expr": {
                "literal": {
                 "s": "string"
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "getOptParamStatements"
               ]
              },
              "ref": {
               "path": [
                "ParamList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "declStmt",
          "expr": {
           "transform": {
            "arg": {
             "name": "paramSuffix"
            },
            "scopevar": "p",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "p"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "VarDecl",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "p"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "identifier",
                         "expr": {
                          "getAttr": {
                           "arg": {
                            "name": "p"
                           },
                           "attr": "varName"
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "TypeName",
                         "expr": {
                          "getAttr": {
                           "arg": {
                            "name": "p"
                           },
                           "attr": "paramType"
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "VarDecl"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "getOptParamStatements"
               ]
              },
              "ref": {
               "path": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "convErrDecl",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "list": {
                "expr": [
                 {
                  "literal": {
                   "s": "convErr"
                  }
                 }
                ]
               }
              },
              "rhs": {
               "binexpr": {
                "op": "GT",
                "lhs": {
                 "call": {
                  "func": ".count",
                  "arg": [
                   {
                    "name": "paramList"
                   }
                  ]
                 }
                },
                "rhs": {
                 "literal": {
                  "i": "0"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "d",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "d"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "VarDecl",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "d"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "identifier",
                         "expr": {
                          "name": "d"
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "TypeName",
                         "expr": {
                          "literal": {
                           "s": "error"
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "VarDecl"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "getOptParamStatements"
               ]
              },
              "ref": {
               "path": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "assignStmt",
          "expr": {
           "call": {
            "func": "getParamStatements",
            "arg": [
             {
              "name": "paramSuffix"
             },
             {
              "name": "methodName"
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "assignVar",
          "expr": {
           "transform": {
            "arg": {
             "name": "paramList"
            },
            "scopevar": "param",
            "stmt": [
             {
              "let": {
               "name": "st",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "param"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "AssignStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "param"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Variables",
                         "expr": {
                          "binexpr": {
                           "op": "ADD",
                           "lhs": {
                            "getAttr": {
                             "arg": {
                              "name": "param"
                             },
                             "attr": "varName"
                            }
                           },
                           "rhs": {
                            "literal": {
                             "s": ", convErr"
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "conversion",
                         "expr": {
                          "ifelse": {
                           "cond": {
                            "binexpr": {
                             "op": "EQ",
                             "lhs": {
                              "getAttr": {
                               "arg": {
                                "name": "param"
                               },
                               "attr": "paramType"
                              }
                             },
                             "rhs": {
                              "literal": {
                               "s": "*bool"
                              }
                             }
                            }
                           },
                           "ifTrue": {
                            "literal": {
                             "s": "convert.StringToBoolPtr"
                            }
                           },
                           "ifFalse": {
                            "ifelse": {
                             "cond": {
                              "binexpr": {
                               "op": "EQ",
                               "lhs": {
                                "getAttr": {
                                 "arg": {
                                  "name": "param"
                                 },
                                 "attr": "paramType"
                                }
                               },
                               "rhs": {
                                "literal": {
                                 "s": "*int64"
                                }
                               }
                              }
                             },
                             "ifTrue": {
                              "literal": {
                               "s": "convert.StringToIntPtr"
                              }
                             },
                             "ifFalse": {
                              "ifelse": {
                               "cond": {
                                "binexpr": {
                                 "op": "EQ",
                                 "lhs": {
                                  "getAttr": {
                                   "arg": {
                                    "name": "param"
                                   },
                                   "attr": "paramType"
                                  }
                                 },
                                 "rhs": {
                                  "literal": {
                                   "s": "*convert.JSONTime"
                                  }
                                 }
                                }
                               },
                               "ifTrue": {
                                "literal": {
                                 "s": "convert.StringToTimePtr"
                                }
                               },
                               "ifFalse": {
                                "literal": {
                                 "s": "convert.StringToStringPtr"
                                }
                               }
                              }
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "conversion"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "conversion"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "name": "conversion"
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "FunctionArgs",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "literal": {
                                       "s": "ctx"
                                      }
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "call": {
                                          "func": "makeValueExpr",
                                          "arg": [
                                           {
                                            "literal": {
                                             "s": "ctx"
                                            }
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "FuncArgsRest",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "list": {
                                            "expr": [
                                             {
                                              "binexpr": {
                                               "op": "ADD",
                                               "lhs": {
                                                "getAttr": {
                                                 "arg": {
                                                  "name": "param"
                                                 },
                                                 "attr": "varNameClean"
                                                }
                                               },
                                               "rhs": {
                                                "literal": {
                                                 "s": "Param"
                                                }
                                               }
                                              }
                                             }
                                            ]
                                           }
                                          },
                                          "scopevar": "arg",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Expression",
                                             "expr": {
                                              "call": {
                                               "func": "makeValueExpr",
                                               "arg": [
                                                {
                                                 "name": "arg"
                                                }
                                               ]
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "sequence": {
                                           "typeRef": {
                                            "context": {
                                             "appname": {
                                              "part": [
                                               "CodeGenTransform"
                                              ]
                                             },
                                             "path": [
                                              "getOptParamStatements"
                                             ]
                                            },
                                            "ref": {
                                             "path": [
                                              "FuncArgsRest"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionArgs"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Expression"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "AssignStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "let": {
               "name": "handleErrStmt",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "handleError",
                   "arg": [
                    {
                     "literal": {
                      "s": "convErr != nil"
                     }
                    },
                    {
                     "literal": {
                      "s": "common.BadRequestError"
                     }
                    },
                    {
                     "literal": {
                      "s": "\"Invalid request\""
                     }
                    },
                    {
                     "literal": {
                      "s": "convErr"
                     }
                    }
                   ]
                  }
                 },
                 "attr": "Statement"
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "list": {
                 "expr": [
                  {
                   "name": "st"
                  },
                  {
                   "name": "handleErrStmt"
                  }
                 ]
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "getOptParamStatements"
               ]
              },
              "ref": {
               "path": [
                "out"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "c1",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "FLATTEN",
              "lhs": {
               "name": "assignVar"
              },
              "rhs": {
               "getAttr": {
                "arg": {
                 "name": "."
                },
                "attr": "out"
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "o",
            "stmt": [
             {
              "let": {
               "name": "c2",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "o"
                 },
                 "scopevar": "o2",
                 "stmt": [
                  {
                   "assign": {
                    "name": "Statement",
                    "expr": {
                     "name": "o2"
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "sequence": {
                  "typeRef": {
                   "context": {
                    "appname": {
                     "part": [
                      "CodeGenTransform"
                     ]
                    },
                    "path": [
                     "getOptParamStatements"
                    ]
                   },
                   "ref": {
                    "path": [
                     "out"
                    ]
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "name": "c2"
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "getOptParamStatements"
               ]
              },
              "ref": {
               "path": [
                "out"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "StatementList",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "binexpr": {
              "op": "BITOR",
              "lhs": {
               "binexpr": {
                "op": "BITOR",
                "lhs": {
                 "name": "declStmt"
                },
                "rhs": {
                 "name": "convErrDecl"
                }
               }
              },
              "rhs": {
               "name": "assignStmt"
              }
             }
            },
            "rhs": {
             "binexpr": {
              "op": "FLATTEN",
              "lhs": {
               "binexpr": {
                "op": "FLATTEN",
                "lhs": {
                 "name": "c1"
                },
                "rhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "out"
                 }
                },
                "scopevar": "."
               }
              },
              "rhs": {
               "name": "."
              },
              "scopevar": "."
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 414,
       "col": 2
      }
     }
    },
    "getPackagePrefix": {
     "param": [
      {
       "name": "payload",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "payload"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "packages",
          "expr": {
           "transform": {
            "arg": {
             "call": {
              "func": "Split",
              "arg": [
               {
                "name": "payload"
               },
               {
                "literal": {
                 "s": "."
                }
               }
              ]
             }
            },
            "scopevar": "p",
            "stmt": [
             {
              "let": {
               "name": "depList",
               "expr": {
                "transform": {
                 "arg": {
                  "binexpr": {
                   "op": "WHERE",
                   "lhs": {
                    "getAttr": {
                     "arg": {
                      "name": "module"
                     },
                     "attr": "apps"
                    }
                   },
                   "rhs": {
                    "binexpr": {
                     "op": "EQ",
                     "lhs": {
                      "getAttr": {
                       "arg": {
                        "getAttr": {
                         "arg": {
                          "name": "."
                         },
                         "attr": "value"
                        }
                       },
                       "attr": "name"
                      }
                     },
                     "rhs": {
                      "name": "p"
                     }
                    }
                   },
                   "scopevar": "."
                  }
                 },
                 "scopevar": "dep",
                 "stmt": [
                  {
                   "assign": {
                    "name": "pkg",
                    "expr": {
                     "getAttr": {
                      "arg": {
                       "getAttr": {
                        "arg": {
                         "getAttr": {
                          "arg": {
                           "name": "dep"
                          },
                          "attr": "value"
                         }
                        },
                        "attr": "attrs"
                       }
                      },
                      "attr": "package"
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "appName",
                    "expr": {
                     "name": "p"
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "set": {
                  "primitive": "STRING",
                  "constraint": [
                  ]
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "pkg",
               "expr": {
                "binexpr": {
                 "op": "FLATTEN",
                 "lhs": {
                  "name": "depList"
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "pkg"
                  }
                 },
                 "scopevar": "."
                }
               }
              }
             },
             {
              "assign": {
               "name": "appName",
               "expr": {
                "binexpr": {
                 "op": "FLATTEN",
                 "lhs": {
                  "name": "depList"
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "appName"
                  }
                 },
                 "scopevar": "."
                }
               }
              }
             }
            ]
           },
           "type": {
            "set": {
             "primitive": "STRING",
             "constraint": [
             ]
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "EQ",
              "lhs": {
               "call": {
                "func": ".count",
                "arg": [
                 {
                  "binexpr": {
                   "op": "FLATTEN",
                   "lhs": {
                    "name": "packages"
                   },
                   "rhs": {
                    "getAttr": {
                     "arg": {
                      "name": "."
                     },
                     "attr": "pkg"
                    }
                   },
                   "scopevar": "."
                  }
                 }
                ]
               }
              },
              "rhs": {
               "literal": {
                "i": "0"
               }
              }
             }
            },
            "ifTrue": {
             "literal": {
              "s": ""
             }
            },
            "ifFalse": {
             "binexpr": {
              "op": "ADD",
              "lhs": {
               "unexpr": {
                "op": "SINGLE",
                "arg": {
                 "binexpr": {
                  "op": "FLATTEN",
                  "lhs": {
                   "name": "packages"
                  },
                  "rhs": {
                   "getAttr": {
                    "arg": {
                     "name": "."
                    },
                    "attr": "pkg"
                   }
                  },
                  "scopevar": "."
                 }
                }
               }
              },
              "rhs": {
               "literal": {
                "s": "."
               }
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "appName",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "EQ",
              "lhs": {
               "call": {
                "func": ".count",
                "arg": [
                 {
                  "binexpr": {
                   "op": "FLATTEN",
                   "lhs": {
                    "name": "packages"
                   },
                   "rhs": {
                    "getAttr": {
                     "arg": {
                      "name": "."
                     },
                     "attr": "appName"
                    }
                   },
                   "scopevar": "."
                  }
                 }
                ]
               }
              },
              "rhs": {
               "literal": {
                "i": "0"
               }
              }
             }
            },
            "ifTrue": {
             "literal": {
              "s": ""
             }
            },
            "ifFalse": {
             "unexpr": {
              "op": "SINGLE",
              "arg": {
               "binexpr": {
                "op": "FLATTEN",
                "lhs": {
                 "name": "packages"
                },
                "rhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "appName"
                 }
                },
                "scopevar": "."
               }
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 541,
       "col": 2
      }
     }
    },
    "getParamStatements": {
     "param": [
      {
       "name": "paramList",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "ParamList"
           ]
          }
         }
        }
       }
      },
      {
       "name": "methodName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "sequence": {
       "typeRef": {
        "context": {
         "appname": {
          "part": [
           "CodeGenTransform"
          ]
         },
         "path": [
          "getParamStatements"
         ]
        },
        "ref": {
         "path": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "paramList"
       },
       "scopevar": "param",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "param"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "AssignStmt",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "paramAssignment",
                   "arg": [
                    {
                     "name": "param"
                    },
                    {
                     "name": "methodName"
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 407,
       "col": 2
      }
     }
    },
    "getParamStatementsDecl": {
     "param": [
      {
       "name": "paramList",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "ParamList"
           ]
          }
         }
        }
       }
      },
      {
       "name": "methodName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "sequence": {
       "typeRef": {
        "context": {
         "appname": {
          "part": [
           "CodeGenTransform"
          ]
         },
         "path": [
          "getParamStatementsDecl"
         ]
        },
        "ref": {
         "path": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "paramList"
       },
       "scopevar": "param",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "param"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "DeclareAndAssignStmt",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "paramAssignment",
                   "arg": [
                    {
                     "name": "param"
                    },
                    {
                     "name": "methodName"
                    }
                   ]
                  }
                 },
                 "attr": "out"
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 400,
       "col": 2
      }
     }
    },
    "getReqVars": {
     "param": [
      {
       "name": "allParams",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "AllParams"
           ]
          }
         }
        }
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Block"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "allParams"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "pps",
          "expr": {
           "call": {
            "func": "getParamStatements",
            "arg": [
             {
              "getAttr": {
               "arg": {
                "name": "allParams"
               },
               "attr": "PathParams"
              }
             },
             {
              "literal": {
               "s": "restlib.GetURLParam"
              }
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "reqQps",
          "expr": {
           "call": {
            "func": "getParamStatements",
            "arg": [
             {
              "getAttr": {
               "arg": {
                "name": "allParams"
               },
               "attr": "ReqQueryParams"
              }
             },
             {
              "literal": {
               "s": "restlib.GetQueryParam"
              }
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "optQps",
          "expr": {
           "getAttr": {
            "arg": {
             "call": {
              "func": "getOptParamStatements",
              "arg": [
               {
                "getAttr": {
                 "arg": {
                  "name": "allParams"
                 },
                 "attr": "OptQueryParams"
                }
               },
               {
                "literal": {
                 "s": "restlib.GetQueryParam"
                }
               }
              ]
             }
            },
            "attr": "StatementList"
           }
          }
         }
        },
        {
         "let": {
          "name": "reqHs",
          "expr": {
           "call": {
            "func": "getParamStatementsDecl",
            "arg": [
             {
              "getAttr": {
               "arg": {
                "name": "allParams"
               },
               "attr": "ReqHeaderParams"
              }
             },
             {
              "literal": {
               "s": "restlib.GetHeaderParam"
              }
             }
            ]
           }
          }
         }
        },
        {
         "assign": {
          "name": "StatementList",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "binexpr": {
              "op": "BITOR",
              "lhs": {
               "binexpr": {
                "op": "BITOR",
                "lhs": {
                 "name": "pps"
                },
                "rhs": {
                 "name": "reqQps"
                }
               }
              },
              "rhs": {
               "name": "optQps"
              }
             }
            },
            "rhs": {
             "name": "reqHs"
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 506,
       "col": 2
      }
     }
    },
    "goFile": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      },
      {
       "name": "basePath",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "goFile"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "app"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "PackageClause",
          "expr": {
           "transform": {
            "arg": {
             "name": "app"
            },
            "scopevar": ".",
            "stmt": [
             {
              "let": {
               "name": "pname",
               "expr": {
                "ifelse": {
                 "cond": {
                  "binexpr": {
                   "op": "NE",
                   "lhs": {
                    "getAttr": {
                     "arg": {
                      "getAttr": {
                       "arg": {
                        "name": "."
                       },
                       "attr": "attrs"
                      }
                     },
                     "attr": "package"
                    }
                   },
                   "rhs": {
                    "literal": {
                     "null": {

                     }
                    },
                    "type": {
                     "primitive": "EMPTY"
                    }
                   }
                  }
                 },
                 "ifTrue": {
                  "getAttr": {
                   "arg": {
                    "getAttr": {
                     "arg": {
                      "name": "."
                     },
                     "attr": "attrs"
                    }
                   },
                   "attr": "package"
                  }
                 },
                 "ifFalse": {
                  "getAttr": {
                   "arg": {
                    "name": "app"
                   },
                   "attr": "name"
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "PackageName",
               "expr": {
                "call": {
                 "func": "ToLower",
                 "arg": [
                  {
                   "name": "pname"
                  }
                 ]
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "PackageClause"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "ImportDecl",
          "expr": {
           "transform": {
            "arg": {
             "name": "app"
            },
            "scopevar": ".",
            "stmt": [
             {
              "let": {
               "name": "convert",
               "expr": {
                "literal": {
                 "s": "github.com/anz-bank/sysl-go/convert"
                }
               }
              }
             },
             {
              "let": {
               "name": "common",
               "expr": {
                "literal": {
                 "s": "github.com/anz-bank/sysl-go/common"
                }
               }
              }
             },
             {
              "let": {
               "name": "database",
               "expr": {
                "literal": {
                 "s": "github.com/anz-bank/sysl-go/database"
                }
               }
              }
             },
             {
              "let": {
               "name": "validator",
               "expr": {
                "literal": {
                 "s": "github.com/anz-bank/sysl-go/validator"
                }
               }
              }
             },
             {
              "let": {
               "name": "db",
               "expr": {
                "literal": {
                 "s": "database/sql"
                }
               }
              }
             },
             {
              "let": {
               "name": "clientImports",
               "expr": {
                "transform": {
                 "arg": {
                  "binexpr": {
                   "op": "FLATTEN",
                   "lhs": {
                    "call": {
                     "func": "makeClientImportList",
                     "arg": [
                      {
                       "name": "app"
                      },
                      {
                       "name": "module"
                      }
                     ]
                    }
                   },
                   "rhs": {
                    "getAttr": {
                     "arg": {
                      "name": "."
                     },
                     "attr": "out"
                    }
                   },
                   "scopevar": "."
                  }
                 },
                 "scopevar": "i",
                 "stmt": [
                  {
                   "assign": {
                    "name": "out",
                    "expr": {
                     "binexpr": {
                      "op": "ADD",
                      "lhs": {
                       "name": "basePath"
                      },
                      "rhs": {
                       "name": "i"
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "set": {
                  "primitive": "STRING",
                  "constraint": [
                  ]
                 }
                }
               }
              }
             },
             {
              "let": {
               "name": "specWithoutDB",
               "expr": {
                "list": {
                 "expr": [
                  {
                   "literal": {
                    "s": "encoding/json"
                   }
                  },
                  {
                   "literal": {
                    "s": "net/http"
                   }
                  },
                  {
                   "literal": {
                    "s": "github.com/anz-bank/sysl-go/restlib"
                   }
                  },
                  {
                   "name": "common"
                  },
                  {
                   "name": "convert"
                  },
                  {
                   "name": "validator"
                  }
                 ]
                }
               }
              }
             },
             {
              "let": {
               "name": "specWithDB",
               "expr": {
                "list": {
                 "expr": [
                  {
                   "literal": {
                    "s": "encoding/json"
                   }
                  },
                  {
                   "literal": {
                    "s": "database/sql"
                   }
                  },
                  {
                   "literal": {
                    "s": "net/http"
                   }
                  },
                  {
                   "literal": {
                    "s": "github.com/anz-bank/sysl-go/restlib"
                   }
                  },
                  {
                   "name": "common"
                  },
                  {
                   "name": "convert"
                  },
                  {
                   "name": "database"
                  },
                  {
                   "name": "validator"
                  }
                 ]
                }
               }
              }
             },
             {
              "let": {
               "name": "spec",
               "expr": {
                "transform": {
                 "arg": {
                  "ifelse": {
                   "cond": {
                    "getAttr": {
                     "arg": {
                      "call": {
                       "func": "IsDataBaseApp",
                       "arg": [
                        {
                         "name": "app"
                        }
                       ]
                      }
                     },
                     "attr": "out"
                    }
                   },
                   "ifTrue": {
                    "name": "specWithDB"
                   },
                   "ifFalse": {
                    "binexpr": {
                     "op": "BITOR",
                     "lhs": {
                      "name": "specWithoutDB"
                     },
                     "rhs": {
                      "binexpr": {
                       "op": "FLATTEN",
                       "lhs": {
                        "name": "clientImports"
                       },
                       "rhs": {
                        "getAttr": {
                         "arg": {
                          "name": "."
                         },
                         "attr": "out"
                        }
                       },
                       "scopevar": "."
                      }
                     }
                    }
                   }
                  }
                 },
                 "scopevar": "importPath",
                 "stmt": [
                  {
                   "assign": {
                    "name": "Import",
                    "expr": {
                     "ifelse": {
                      "cond": {
                       "binexpr": {
                        "op": "EQ",
                        "lhs": {
                         "name": "importPath"
                        },
                        "rhs": {
                         "literal": {
                          "s": ""
                         }
                        }
                       }
                      },
                      "ifTrue": {
                       "literal": {
                        "b": true
                       },
                       "type": {
                        "primitive": "BOOL"
                       }
                      },
                      "ifFalse": {
                       "binexpr": {
                        "op": "ADD",
                        "lhs": {
                         "binexpr": {
                          "op": "ADD",
                          "lhs": {
                           "literal": {
                            "s": "\""
                           }
                          },
                          "rhs": {
                           "name": "importPath"
                          }
                         }
                        },
                        "rhs": {
                         "literal": {
                          "s": "\""
                         }
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "sequence": {
                  "typeRef": {
                   "context": {
                    "appname": {
                     "part": [
                      "CodeGenTransform"
                     ]
                    },
                    "path": [
                     "goFile"
                    ]
                   },
                   "ref": {
                    "path": [
                     "ImportSpec"
                    ]
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "ImportSpec",
               "expr": {
                "name": "spec"
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "ImportDecl"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "serviceImplVarname",
          "expr": {
           "literal": {
            "s": "serviceInterface"
           }
          }
         }
        },
        {
         "let": {
          "name": "svcInterface",
          "expr": {
           "transform": {
            "arg": {
             "list": {
              "expr": [
               {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "name"
                }
               }
              ]
             }
            },
            "scopevar": "name",
            "stmt": [
             {
              "let": {
               "name": "title",
               "expr": {
                "literal": {
                 "s": "Handler"
                }
               }
              }
             },
             {
              "assign": {
               "name": "Comment",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "literal": {
                   "s": "// Handler interface for "
                  }
                 },
                 "rhs": {
                  "name": "name"
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "Declaration",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "title"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "InterfaceType",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "title"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "InterfaceName",
                         "expr": {
                          "name": "title"
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "MethodSpec",
                         "expr": {
                          "call": {
                           "func": "epHandlerMethodSpecs",
                           "arg": [
                            {
                             "getAttr": {
                              "arg": {
                               "name": "app"
                              },
                              "attr": "endpoints"
                             }
                            }
                           ]
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "InterfaceType"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Declaration"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "goFile"
               ]
              },
              "ref": {
               "path": [
                "TopLevelDecl"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "serviceHandlerStruct",
          "expr": {
           "transform": {
            "arg": {
             "list": {
              "expr": [
               {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "name"
                }
               }
              ]
             }
            },
            "scopevar": "name",
            "stmt": [
             {
              "assign": {
               "name": "Comment",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "binexpr": {
                   "op": "ADD",
                   "lhs": {
                    "literal": {
                     "s": "// ServiceHandler for "
                    }
                   },
                   "rhs": {
                    "name": "name"
                   }
                  }
                 },
                 "rhs": {
                  "literal": {
                   "s": " API"
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "Declaration",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "name"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "StructType",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "name"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "StructName",
                         "expr": {
                          "literal": {
                           "s": "ServiceHandler"
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "genCallback",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "name"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "identifier",
                              "expr": {
                               "literal": {
                                "s": "genCallback"
                               }
                              }
                             }
                            },
                            {
                             "assign": {
                              "name": "Type",
                              "expr": {
                               "literal": {
                                "s": "GenCallback"
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "FieldDecl"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "svcHandlerField",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "name"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "identifier",
                              "expr": {
                               "name": "serviceImplVarname"
                              }
                             }
                            },
                            {
                             "assign": {
                              "name": "Type",
                              "expr": {
                               "literal": {
                                "s": "*ServiceInterface"
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "FieldDecl"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "dbPoolField",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "name"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "identifier",
                              "expr": {
                               "literal": {
                                "s": "DB"
                               }
                              }
                             }
                            },
                            {
                             "assign": {
                              "name": "Type",
                              "expr": {
                               "literal": {
                                "s": "*sql.DB"
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "FieldDecl"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "clientStruct",
                         "expr": {
                          "transform": {
                           "arg": {
                            "binexpr": {
                             "op": "FLATTEN",
                             "lhs": {
                              "call": {
                               "func": "makeClientStruct",
                               "arg": [
                                {
                                 "name": "app"
                                },
                                {
                                 "name": "module"
                                }
                               ]
                              }
                             },
                             "rhs": {
                              "getAttr": {
                               "arg": {
                                "name": "."
                               },
                               "attr": "out"
                              }
                             },
                             "scopevar": "."
                            }
                           },
                           "scopevar": "c",
                           "stmt": [
                            {
                             "assign": {
                              "name": "out",
                              "expr": {
                               "name": "c"
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "set": {
                            "typeRef": {
                             "context": {
                              "appname": {
                               "part": [
                                "CodeGenTransform"
                               ]
                              }
                             },
                             "ref": {
                              "appname": {
                               "part": [
                                "out"
                               ]
                              }
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "fieldDeclWithoutDB",
                         "expr": {
                          "list": {
                           "expr": [
                            {
                             "name": "genCallback"
                            },
                            {
                             "name": "svcHandlerField"
                            }
                           ]
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "fieldDeclWithDB",
                         "expr": {
                          "list": {
                           "expr": [
                            {
                             "name": "genCallback"
                            },
                            {
                             "name": "svcHandlerField"
                            },
                            {
                             "name": "dbPoolField"
                            }
                           ]
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "FieldDecl",
                         "expr": {
                          "ifelse": {
                           "cond": {
                            "getAttr": {
                             "arg": {
                              "call": {
                               "func": "IsDataBaseApp",
                               "arg": [
                                {
                                 "name": "app"
                                }
                               ]
                              }
                             },
                             "attr": "out"
                            }
                           },
                           "ifTrue": {
                            "name": "fieldDeclWithDB"
                           },
                           "ifFalse": {
                            "binexpr": {
                             "op": "BITOR",
                             "lhs": {
                              "name": "fieldDeclWithoutDB"
                             },
                             "rhs": {
                              "binexpr": {
                               "op": "FLATTEN",
                               "lhs": {
                                "name": "clientStruct"
                               },
                               "rhs": {
                                "getAttr": {
                                 "arg": {
                                  "name": "."
                                 },
                                 "attr": "out"
                                }
                               },
                               "scopevar": "."
                              }
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "StructType"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Declaration"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "goFile"
               ]
              },
              "ref": {
               "path": [
                "TopLevelDecl"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "newServiceHandler",
          "expr": {
           "transform": {
            "arg": {
             "list": {
              "expr": [
               {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "name"
                }
               }
              ]
             }
            },
            "scopevar": "name",
            "stmt": [
             {
              "assign": {
               "name": "Comment",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "literal": {
                   "s": "// NewServiceHandler for "
                  }
                 },
                 "rhs": {
                  "name": "name"
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "FunctionDecl",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "name"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "FunctionName",
                    "expr": {
                     "literal": {
                      "s": "NewServiceHandler"
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Signature",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "name"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Parameters",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "name"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "ParameterList",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "name"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "ParameterDecl",
                                   "expr": {
                                    "call": {
                                     "func": "paramDecl",
                                     "arg": [
                                      {
                                       "literal": {
                                        "s": "genCallback"
                                       }
                                      },
                                      {
                                       "literal": {
                                        "s": "GenCallback"
                                       }
                                      }
                                     ]
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "let": {
                                   "name": "genCallback",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "name"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "ParameterDecl",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "name"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Identifier",
                                             "expr": {
                                              "name": "serviceImplVarname"
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "TypeName",
                                             "expr": {
                                              "literal": {
                                               "s": "*ServiceInterface"
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "ParameterDecl"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ParameterDeclC"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "let": {
                                   "name": "clientParam",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "binexpr": {
                                       "op": "FLATTEN",
                                       "lhs": {
                                        "call": {
                                         "func": "makeClientParam",
                                         "arg": [
                                          {
                                           "name": "app"
                                          },
                                          {
                                           "name": "module"
                                          }
                                         ]
                                        }
                                       },
                                       "rhs": {
                                        "getAttr": {
                                         "arg": {
                                          "name": "."
                                         },
                                         "attr": "out"
                                        }
                                       },
                                       "scopevar": "."
                                      }
                                     },
                                     "scopevar": "p",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "out",
                                        "expr": {
                                         "name": "p"
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "set": {
                                      "typeRef": {
                                       "context": {
                                        "appname": {
                                         "part": [
                                          "CodeGenTransform"
                                         ]
                                        }
                                       },
                                       "ref": {
                                        "appname": {
                                         "part": [
                                          "out"
                                         ]
                                        }
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "ParameterDeclC",
                                   "expr": {
                                    "binexpr": {
                                     "op": "BITOR",
                                     "lhs": {
                                      "list": {
                                       "expr": [
                                        {
                                         "name": "genCallback"
                                        }
                                       ]
                                      }
                                     },
                                     "rhs": {
                                      "binexpr": {
                                       "op": "FLATTEN",
                                       "lhs": {
                                        "name": "clientParam"
                                       },
                                       "rhs": {
                                        "getAttr": {
                                         "arg": {
                                          "name": "."
                                         },
                                         "attr": "out"
                                        }
                                       },
                                       "scopevar": "."
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "ParameterList"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Parameters"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Result",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "name"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "TypeName",
                              "expr": {
                               "literal": {
                                "s": "*ServiceHandler"
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Result"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Signature"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Block",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "name"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "StatementList",
                         "expr": {
                          "ifelse": {
                           "cond": {
                            "getAttr": {
                             "arg": {
                              "call": {
                               "func": "IsDataBaseApp",
                               "arg": [
                                {
                                 "name": "app"
                                }
                               ]
                              }
                             },
                             "attr": "out"
                            }
                           },
                           "ifTrue": {
                            "getAttr": {
                             "arg": {
                              "call": {
                               "func": "setServiceHandlerWithDBPool",
                               "arg": [
                                {
                                 "literal": {
                                  "s": "@req"
                                 }
                                },
                                {
                                 "name": "app"
                                },
                                {
                                 "name": "module"
                                },
                                {
                                 "name": "serviceImplVarname"
                                }
                               ]
                              }
                             },
                             "attr": "StatementList"
                            }
                           },
                           "ifFalse": {
                            "getAttr": {
                             "arg": {
                              "call": {
                               "func": "setServiceHandlerWithoutDBPool",
                               "arg": [
                                {
                                 "literal": {
                                  "s": "@req"
                                 }
                                },
                                {
                                 "name": "app"
                                },
                                {
                                 "name": "module"
                                },
                                {
                                 "name": "serviceImplVarname"
                                }
                               ]
                              }
                             },
                             "attr": "StatementList"
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Block"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "FunctionDecl"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "goFile"
               ]
              },
              "ref": {
               "path": [
                "TopLevelDecl"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "handleErrorMapAndWrite",
          "expr": {
           "transform": {
            "arg": {
             "list": {
              "expr": [
               {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "name"
                }
               }
              ]
             }
            },
            "scopevar": "name",
            "stmt": [
             {
              "assign": {
               "name": "Comment",
               "expr": {
                "literal": {
                 "s": "// Handler Error "
                }
               }
              }
             },
             {
              "assign": {
               "name": "MethodDecl",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "name"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "FunctionName",
                    "expr": {
                     "literal": {
                      "s": "HandleError"
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Receiver",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "name"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "ReceiverType",
                         "expr": {
                          "literal": {
                           "s": "s *ServiceHandler"
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Receiver"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Signature",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "name"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Parameters",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "name"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "ParameterList",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "name"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "ParameterDecl",
                                   "expr": {
                                    "call": {
                                     "func": "paramDecl",
                                     "arg": [
                                      {
                                       "literal": {
                                        "s": "ctx"
                                       }
                                      },
                                      {
                                       "literal": {
                                        "s": "context.Context"
                                       }
                                      }
                                     ]
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "let": {
                                   "name": "responseWriter",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "name"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "ParameterDecl",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "name"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Identifier",
                                             "expr": {
                                              "literal": {
                                               "s": "w"
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "TypeName",
                                             "expr": {
                                              "literal": {
                                               "s": "http.ResponseWriter"
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "ParameterDecl"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ParameterDeclC"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "let": {
                                   "name": "kind",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "name"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "ParameterDecl",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "name"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Identifier",
                                             "expr": {
                                              "literal": {
                                               "s": "kind"
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "TypeName",
                                             "expr": {
                                              "literal": {
                                               "s": "common.Kind"
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "ParameterDecl"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ParameterDeclC"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "let": {
                                   "name": "message",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "name"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "ParameterDecl",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "name"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Identifier",
                                             "expr": {
                                              "literal": {
                                               "s": "message"
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "TypeName",
                                             "expr": {
                                              "literal": {
                                               "s": "string"
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "ParameterDecl"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ParameterDeclC"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "let": {
                                   "name": "cause",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "name"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "ParameterDecl",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "name"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Identifier",
                                             "expr": {
                                              "literal": {
                                               "s": "cause"
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "TypeName",
                                             "expr": {
                                              "literal": {
                                               "s": "error"
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "ParameterDecl"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ParameterDeclC"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "ParameterDeclC",
                                   "expr": {
                                    "list": {
                                     "expr": [
                                      {
                                       "name": "responseWriter"
                                      },
                                      {
                                       "name": "kind"
                                      },
                                      {
                                       "name": "message"
                                      },
                                      {
                                       "name": "cause"
                                      }
                                     ]
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "ParameterList"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Parameters"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Signature"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Block",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "name"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "let": {
                         "name": "mapError",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "name"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "name"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "DeclareAndAssignStmt",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "name"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Variables",
                                        "expr": {
                                         "literal": {
                                          "s": "httpError"
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "name"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "FunctionCall",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "name"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "FunctionName",
                                                  "expr": {
                                                   "literal": {
                                                    "s": "s.genCallback.MapError"
                                                   }
                                                  }
                                                 }
                                                },
                                                {
                                                 "assign": {
                                                  "name": "FunctionArgs",
                                                  "expr": {
                                                   "transform": {
                                                    "arg": {
                                                     "name": "name"
                                                    },
                                                    "scopevar": ".",
                                                    "stmt": [
                                                     {
                                                      "assign": {
                                                       "name": "Expression",
                                                       "expr": {
                                                        "transform": {
                                                         "arg": {
                                                          "name": "name"
                                                         },
                                                         "scopevar": ".",
                                                         "stmt": [
                                                          {
                                                           "assign": {
                                                            "name": "ValueExpr",
                                                            "expr": {
                                                             "literal": {
                                                              "s": "ctx, w, kind, message, cause"
                                                             }
                                                            }
                                                           }
                                                          }
                                                         ]
                                                        },
                                                        "type": {
                                                         "typeRef": {
                                                          "context": {
                                                           "appname": {
                                                            "part": [
                                                             "CodeGenTransform"
                                                            ]
                                                           }
                                                          },
                                                          "ref": {
                                                           "appname": {
                                                            "part": [
                                                             "Expression"
                                                            ]
                                                           }
                                                          }
                                                         }
                                                        }
                                                       }
                                                      }
                                                     }
                                                    ]
                                                   },
                                                   "type": {
                                                    "typeRef": {
                                                     "context": {
                                                      "appname": {
                                                       "part": [
                                                        "CodeGenTransform"
                                                       ]
                                                      }
                                                     },
                                                     "ref": {
                                                      "appname": {
                                                       "part": [
                                                        "FunctionArgs"
                                                       ]
                                                      }
                                                     }
                                                    }
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FunctionCall"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "Expression"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "DeclareAndAssignStmt"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "writeError",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "name"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "name"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionCall",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "name"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "FunctionName",
                                        "expr": {
                                         "literal": {
                                          "s": "httpError.WriteError"
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "FunctionArgs",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "name"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Expression",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "name"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "ValueExpr",
                                                  "expr": {
                                                   "literal": {
                                                    "s": "ctx, w"
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "Expression"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "FunctionArgs"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionCall"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "StatementList",
                         "expr": {
                          "list": {
                           "expr": [
                            {
                             "name": "mapError"
                            },
                            {
                             "name": "writeError"
                            }
                           ]
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Block"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "FunctionDecl"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "goFile"
               ]
              },
              "ref": {
               "path": [
                "TopLevelDecl"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "Comment",
          "expr": {
           "literal": {
            "s": "// Code generated by sysl DO NOT EDIT.\n"
           }
          }
         }
        },
        {
         "assign": {
          "name": "TopLevelDecl",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "binexpr": {
              "op": "BITOR",
              "lhs": {
               "binexpr": {
                "op": "BITOR",
                "lhs": {
                 "binexpr": {
                  "op": "BITOR",
                  "lhs": {
                   "name": "svcInterface"
                  },
                  "rhs": {
                   "name": "serviceHandlerStruct"
                  }
                 }
                },
                "rhs": {
                 "name": "newServiceHandler"
                }
               }
              },
              "rhs": {
               "name": "handleErrorMapAndWrite"
              }
             }
            },
            "rhs": {
             "call": {
              "func": "EpHandlerMethodDecl",
              "arg": [
               {
                "name": "app"
               },
               {
                "name": "pname"
               },
               {
                "name": "module"
               }
              ]
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 969,
       "col": 2
      }
     }
    },
    "handleError": {
     "param": [
      {
       "name": "condition",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "errorCode",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "errorMsg",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "errorObj",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "condition"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "condition"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "IfElseStmt",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "condition"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "Expression",
                    "expr": {
                     "call": {
                      "func": "makeValueExpr",
                      "arg": [
                       {
                        "name": "condition"
                       }
                      ]
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Block",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "condition"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "let": {
                         "name": "interfaceCall",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "condition"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "condition"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionCall",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "condition"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "FunctionName",
                                        "expr": {
                                         "literal": {
                                          "s": "s.HandleError"
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "FunctionArgs",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "condition"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Expression",
                                             "expr": {
                                              "call": {
                                               "func": "makeValueExpr",
                                               "arg": [
                                                {
                                                 "literal": {
                                                  "s": "ctx"
                                                 }
                                                }
                                               ]
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "let": {
                                             "name": "writer",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "condition"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "literal": {
                                                       "s": "w"
                                                      }
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FuncArgsRest"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "let": {
                                             "name": "code",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "errorCode"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "name": "errorCode"
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FuncArgsRest"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "let": {
                                             "name": "msg",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "errorMsg"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "name": "errorMsg"
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FuncArgsRest"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "let": {
                                             "name": "error",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "errorObj"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "name": "errorObj"
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FuncArgsRest"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "FuncArgsRest",
                                             "expr": {
                                              "list": {
                                               "expr": [
                                                {
                                                 "name": "writer"
                                                },
                                                {
                                                 "name": "code"
                                                },
                                                {
                                                 "name": "msg"
                                                },
                                                {
                                                 "name": "error"
                                                }
                                               ]
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "FunctionArgs"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ReturnStmt"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "returnStmt",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "condition"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "condition"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "ReturnStmt",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "condition"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "PayLoad",
                                        "expr": {
                                         "literal": {
                                          "s": ""
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ReturnStmt"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "StatementList",
                         "expr": {
                          "list": {
                           "expr": [
                            {
                             "name": "interfaceCall"
                            },
                            {
                             "name": "returnStmt"
                            }
                           ]
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Block"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "IfElseStmt"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 125,
       "col": 2
      }
     }
    },
    "handleErrorReturnNil": {
     "param": [
      {
       "name": "condition",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "condition"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "condition"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "IfElseStmt",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "condition"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "Expression",
                    "expr": {
                     "call": {
                      "func": "makeValueExpr",
                      "arg": [
                       {
                        "name": "condition"
                       }
                      ]
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Block",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "condition"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "let": {
                         "name": "returnStmt",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "condition"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "condition"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "ReturnStmt",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "condition"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "PayLoad",
                                        "expr": {
                                         "literal": {
                                          "s": "nil"
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ReturnStmt"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "StatementList",
                         "expr": {
                          "list": {
                           "expr": [
                            {
                             "name": "returnStmt"
                            }
                           ]
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Block"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "IfElseStmt"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 56,
       "col": 2
      }
     }
    },
    "handleErrorWithRollback": {
     "param": [
      {
       "name": "condition",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "errorCode",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "errorMsg",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "errorObj",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "condition"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "condition"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "IfElseStmt",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "condition"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "Expression",
                    "expr": {
                     "call": {
                      "func": "makeValueExpr",
                      "arg": [
                       {
                        "name": "condition"
                       }
                      ]
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Block",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "condition"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "let": {
                         "name": "rollbackStmt",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "condition"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "condition"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionCall",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "condition"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "FunctionName",
                                        "expr": {
                                         "literal": {
                                          "s": "tx.Rollback"
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionCall"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "interfaceCall",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "condition"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "condition"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionCall",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "condition"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "FunctionName",
                                        "expr": {
                                         "literal": {
                                          "s": "s.HandleError"
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "FunctionArgs",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "name": "condition"
                                          },
                                          "scopevar": ".",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Expression",
                                             "expr": {
                                              "call": {
                                               "func": "makeValueExpr",
                                               "arg": [
                                                {
                                                 "literal": {
                                                  "s": "ctx"
                                                 }
                                                }
                                               ]
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "let": {
                                             "name": "writer",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "condition"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "literal": {
                                                       "s": "w"
                                                      }
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FuncArgsRest"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "let": {
                                             "name": "code",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "errorCode"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "name": "errorCode"
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FuncArgsRest"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "let": {
                                             "name": "msg",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "errorMsg"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "name": "errorMsg"
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FuncArgsRest"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "let": {
                                             "name": "error",
                                             "expr": {
                                              "transform": {
                                               "arg": {
                                                "name": "errorObj"
                                               },
                                               "scopevar": ".",
                                               "stmt": [
                                                {
                                                 "assign": {
                                                  "name": "Expression",
                                                  "expr": {
                                                   "call": {
                                                    "func": "makeValueExpr",
                                                    "arg": [
                                                     {
                                                      "name": "errorObj"
                                                     }
                                                    ]
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              },
                                              "type": {
                                               "typeRef": {
                                                "context": {
                                                 "appname": {
                                                  "part": [
                                                   "CodeGenTransform"
                                                  ]
                                                 }
                                                },
                                                "ref": {
                                                 "appname": {
                                                  "part": [
                                                   "FuncArgsRest"
                                                  ]
                                                 }
                                                }
                                               }
                                              }
                                             }
                                            }
                                           },
                                           {
                                            "assign": {
                                             "name": "FuncArgsRest",
                                             "expr": {
                                              "list": {
                                               "expr": [
                                                {
                                                 "name": "writer"
                                                },
                                                {
                                                 "name": "code"
                                                },
                                                {
                                                 "name": "msg"
                                                },
                                                {
                                                 "name": "error"
                                                }
                                               ]
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "typeRef": {
                                           "context": {
                                            "appname": {
                                             "part": [
                                              "CodeGenTransform"
                                             ]
                                            }
                                           },
                                           "ref": {
                                            "appname": {
                                             "part": [
                                              "FunctionArgs"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ReturnStmt"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "let": {
                         "name": "returnStmt",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "condition"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Statement",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "condition"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "ReturnStmt",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "condition"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "PayLoad",
                                        "expr": {
                                         "literal": {
                                          "s": ""
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "ReturnStmt"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "Statement"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "StatementList"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "StatementList",
                         "expr": {
                          "list": {
                           "expr": [
                            {
                             "name": "rollbackStmt"
                            },
                            {
                             "name": "interfaceCall"
                            },
                            {
                             "name": "returnStmt"
                            }
                           ]
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Block"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "IfElseStmt"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 75,
       "col": 2
      }
     }
    },
    "jsonDecode": {
     "param": [
      {
       "name": "bodyParams",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "BodyParams"
           ]
          }
         }
        }
       }
      },
      {
       "name": "packageName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Block"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "packageName"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "decodeErr",
          "expr": {
           "literal": {
            "s": "decodeErr"
           }
          }
         }
        },
        {
         "let": {
          "name": "decodeStmts",
          "expr": {
           "transform": {
            "arg": {
             "name": "bodyParams"
            },
            "scopevar": "param",
            "stmt": [
             {
              "let": {
               "name": "decode",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "param"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "DeclareAndAssignStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "param"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Variables",
                         "expr": {
                          "name": "decodeErr"
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "param"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "param"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "literal": {
                                     "s": "decoder.Decode"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "FunctionArgs",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "param"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "call": {
                                          "func": "makeValueExpr",
                                          "arg": [
                                           {
                                            "literal": {
                                             "s": "\u0026req.Request"
                                            }
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionArgs"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Expression"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "DeclareAndAssignStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "name": "decode"
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "jsonDecode"
               ]
              },
              "ref": {
               "path": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "StatementList",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "name": "decodeStmts"
            },
            "rhs": {
             "list": {
              "expr": [
               {
                "call": {
                 "func": "handleError",
                 "arg": [
                  {
                   "binexpr": {
                    "op": "ADD",
                    "lhs": {
                     "name": "decodeErr"
                    },
                    "rhs": {
                     "literal": {
                      "s": " != nil"
                     }
                    }
                   }
                  },
                  {
                   "literal": {
                    "s": "common.BadRequestError"
                   }
                  },
                  {
                   "literal": {
                    "s": "\"Error reading request body\""
                   }
                  },
                  {
                   "name": "decodeErr"
                  }
                 ]
                }
               }
              ]
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 175,
       "col": 2
      }
     }
    },
    "jsonDecoder": {
     "param": [
      {
       "name": "decoderName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "decoderName"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "decoderName"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "DeclareAndAssignStmt",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "decoderName"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "Variables",
                    "expr": {
                     "name": "decoderName"
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Expression",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "decoderName"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "FunctionCall",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "decoderName"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionName",
                              "expr": {
                               "literal": {
                                "s": "json.NewDecoder"
                               }
                              }
                             }
                            },
                            {
                             "assign": {
                              "name": "FunctionArgs",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "decoderName"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "Expression",
                                   "expr": {
                                    "call": {
                                     "func": "makeValueExpr",
                                     "arg": [
                                      {
                                       "literal": {
                                        "s": "r.Body"
                                       }
                                      }
                                     ]
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionArgs"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "FunctionCall"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "Expression"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "DeclareAndAssignStmt"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 608,
       "col": 2
      }
     }
    },
    "makeClient": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "NewStruct"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "StructName",
          "expr": {
           "getAttr": {
            "arg": {
             "call": {
              "func": "makeEpClientName",
              "arg": [
               {
                "name": "ep"
               }
              ]
             }
            },
            "attr": "out"
           }
          }
         }
        },
        {
         "let": {
          "name": "sf",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "stmts"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "type"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "call"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "call",
            "stmt": [
             {
              "let": {
               "name": "depList",
               "expr": {
                "transform": {
                 "arg": {
                  "binexpr": {
                   "op": "WHERE",
                   "lhs": {
                    "getAttr": {
                     "arg": {
                      "name": "module"
                     },
                     "attr": "apps"
                    }
                   },
                   "rhs": {
                    "binexpr": {
                     "op": "EQ",
                     "lhs": {
                      "getAttr": {
                       "arg": {
                        "getAttr": {
                         "arg": {
                          "name": "."
                         },
                         "attr": "value"
                        }
                       },
                       "attr": "name"
                      }
                     },
                     "rhs": {
                      "getAttr": {
                       "arg": {
                        "name": "call"
                       },
                       "attr": "target"
                      }
                     }
                    }
                   },
                   "scopevar": "."
                  }
                 },
                 "scopevar": "dep",
                 "stmt": [
                  {
                   "let": {
                    "name": "depEpList",
                    "expr": {
                     "transform": {
                      "arg": {
                       "binexpr": {
                        "op": "WHERE",
                        "lhs": {
                         "getAttr": {
                          "arg": {
                           "getAttr": {
                            "arg": {
                             "name": "dep"
                            },
                            "attr": "value"
                           }
                          },
                          "attr": "endpoints"
                         }
                        },
                        "rhs": {
                         "binexpr": {
                          "op": "EQ",
                          "lhs": {
                           "getAttr": {
                            "arg": {
                             "getAttr": {
                              "arg": {
                               "name": "."
                              },
                              "attr": "value"
                             }
                            },
                            "attr": "name"
                           }
                          },
                          "rhs": {
                           "getAttr": {
                            "arg": {
                             "name": "call"
                            },
                            "attr": "endpoint"
                           }
                          }
                         }
                        },
                        "scopevar": "."
                       }
                      },
                      "scopevar": "depEp",
                      "stmt": [
                       {
                        "assign": {
                         "name": "identifier",
                         "expr": {
                          "getAttr": {
                           "arg": {
                            "call": {
                             "func": "methodDef",
                             "arg": [
                              {
                               "name": "depEp"
                              }
                             ]
                            }
                           },
                           "attr": "methodName"
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "depEp"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "ValueExpr",
                              "expr": {
                               "binexpr": {
                                "op": "ADD",
                                "lhs": {
                                 "binexpr": {
                                  "op": "ADD",
                                  "lhs": {
                                   "binexpr": {
                                    "op": "ADD",
                                    "lhs": {
                                     "binexpr": {
                                      "op": "ADD",
                                      "lhs": {
                                       "binexpr": {
                                        "op": "ADD",
                                        "lhs": {
                                         "literal": {
                                          "s": "s."
                                         }
                                        },
                                        "rhs": {
                                         "getAttr": {
                                          "arg": {
                                           "getAttr": {
                                            "arg": {
                                             "getAttr": {
                                              "arg": {
                                               "name": "dep"
                                              },
                                              "attr": "value"
                                             }
                                            },
                                            "attr": "attrs"
                                           }
                                          },
                                          "attr": "package"
                                         }
                                        }
                                       }
                                      },
                                      "rhs": {
                                       "getAttr": {
                                        "arg": {
                                         "getAttr": {
                                          "arg": {
                                           "name": "dep"
                                          },
                                          "attr": "value"
                                         }
                                        },
                                        "attr": "name"
                                       }
                                      }
                                     }
                                    },
                                    "rhs": {
                                     "literal": {
                                      "s": "Service"
                                     }
                                    }
                                   }
                                  },
                                  "rhs": {
                                   "literal": {
                                    "s": "."
                                   }
                                  }
                                 }
                                },
                                "rhs": {
                                 "getAttr": {
                                  "arg": {
                                   "call": {
                                    "func": "methodDef",
                                    "arg": [
                                     {
                                      "name": "depEp"
                                     }
                                    ]
                                   }
                                  },
                                  "attr": "methodName"
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Expression"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "sequence": {
                       "typeRef": {
                        "context": {
                         "appname": {
                          "part": [
                           "CodeGenTransform"
                          ]
                         },
                         "path": [
                          "makeClient"
                         ]
                        },
                        "ref": {
                         "path": [
                          "out"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "out",
                    "expr": {
                     "name": "depEpList"
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "sequence": {
                  "typeRef": {
                   "context": {
                    "appname": {
                     "part": [
                      "CodeGenTransform"
                     ]
                    },
                    "path": [
                     "makeClient"
                    ]
                   },
                   "ref": {
                    "path": [
                     "out"
                    ]
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "binexpr": {
                 "op": "FLATTEN",
                 "lhs": {
                  "binexpr": {
                   "op": "FLATTEN",
                   "lhs": {
                    "name": "depList"
                   },
                   "rhs": {
                    "getAttr": {
                     "arg": {
                      "name": "."
                     },
                     "attr": "out"
                    }
                   },
                   "scopevar": "."
                  }
                 },
                 "rhs": {
                  "name": "."
                 },
                 "scopevar": "."
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "makeClient"
               ]
              },
              "ref": {
               "path": [
                "out"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "dbParam",
          "expr": {
           "transform": {
            "arg": {
             "literal": {
              "s": "dbParam"
             }
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "identifier",
               "expr": {
                "literal": {
                 "s": "conn"
                }
               }
              }
             },
             {
              "assign": {
               "name": "Expression",
               "expr": {
                "transform": {
                 "arg": {
                  "literal": {
                   "s": "Expr"
                  }
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "ValueExpr",
                    "expr": {
                     "literal": {
                      "s": "conn"
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Expression"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "out"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "queryAttributes",
          "expr": {
           "getAttr": {
            "arg": {
             "call": {
              "func": "SetQueryAttributes",
              "arg": [
               {
                "name": "ep"
               }
              ]
             }
            },
            "attr": "out"
           }
          }
         }
        },
        {
         "let": {
          "name": "StructFieldWithoutDB",
          "expr": {
           "binexpr": {
            "op": "FLATTEN",
            "lhs": {
             "binexpr": {
              "op": "FLATTEN",
              "lhs": {
               "name": "sf"
              },
              "rhs": {
               "getAttr": {
                "arg": {
                 "name": "."
                },
                "attr": "out"
               }
              },
              "scopevar": "."
             }
            },
            "rhs": {
             "name": "."
            },
            "scopevar": "."
           }
          }
         }
        },
        {
         "let": {
          "name": "StructFieldWithDB",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "binexpr": {
              "op": "BITOR",
              "lhs": {
               "list": {
                "expr": [
                 {
                  "name": "dbParam"
                 }
                ]
               }
              },
              "rhs": {
               "name": "queryAttributes"
              }
             }
            },
            "rhs": {
             "binexpr": {
              "op": "FLATTEN",
              "lhs": {
               "binexpr": {
                "op": "FLATTEN",
                "lhs": {
                 "name": "sf"
                },
                "rhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "out"
                 }
                },
                "scopevar": "."
               }
              },
              "rhs": {
               "name": "."
              },
              "scopevar": "."
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "StructField",
          "expr": {
           "ifelse": {
            "cond": {
             "getAttr": {
              "arg": {
               "call": {
                "func": "IsDataBaseApp",
                "arg": [
                 {
                  "name": "app"
                 }
                ]
               }
              },
              "attr": "out"
             }
            },
            "ifTrue": {
             "name": "StructFieldWithDB"
            },
            "ifFalse": {
             "name": "StructFieldWithoutDB"
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 893,
       "col": 2
      }
     }
    },
    "makeClientImportList": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "set": {
       "primitive": "STRING",
       "constraint": [
       ]
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "getAttr": {
         "arg": {
          "name": "app"
         },
         "attr": "endpoints"
        }
       },
       "scopevar": "ep",
       "stmt": [
        {
         "let": {
          "name": "callList",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "stmts"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "type"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "call"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "call",
            "stmt": [
             {
              "let": {
               "name": "depList",
               "expr": {
                "transform": {
                 "arg": {
                  "binexpr": {
                   "op": "WHERE",
                   "lhs": {
                    "getAttr": {
                     "arg": {
                      "name": "module"
                     },
                     "attr": "apps"
                    }
                   },
                   "rhs": {
                    "binexpr": {
                     "op": "EQ",
                     "lhs": {
                      "getAttr": {
                       "arg": {
                        "getAttr": {
                         "arg": {
                          "name": "."
                         },
                         "attr": "value"
                        }
                       },
                       "attr": "name"
                      }
                     },
                     "rhs": {
                      "getAttr": {
                       "arg": {
                        "name": "call"
                       },
                       "attr": "target"
                      }
                     }
                    }
                   },
                   "scopevar": "."
                  }
                 },
                 "scopevar": "dep",
                 "stmt": [
                  {
                   "assign": {
                    "name": "out",
                    "expr": {
                     "getAttr": {
                      "arg": {
                       "getAttr": {
                        "arg": {
                         "getAttr": {
                          "arg": {
                           "name": "dep"
                          },
                          "attr": "value"
                         }
                        },
                        "attr": "attrs"
                       }
                      },
                      "attr": "package"
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "set": {
                  "typeRef": {
                   "context": {
                    "appname": {
                     "part": [
                      "CodeGenTransform"
                     ]
                    }
                   },
                   "ref": {
                    "appname": {
                     "part": [
                      "out"
                     ]
                    }
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "binexpr": {
                 "op": "FLATTEN",
                 "lhs": {
                  "name": "depList"
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "out"
                  }
                 },
                 "scopevar": "."
                }
               }
              }
             }
            ]
           },
           "type": {
            "set": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               }
              },
              "ref": {
               "appname": {
                "part": [
                 "out"
                ]
               }
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "binexpr": {
            "op": "FLATTEN",
            "lhs": {
             "name": "callList"
            },
            "rhs": {
             "getAttr": {
              "arg": {
               "name": "."
              },
              "attr": "out"
             }
            },
            "scopevar": "."
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 958,
       "col": 2
      }
     }
    },
    "makeClientParam": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "set": {
       "typeRef": {
        "ref": {
         "appname": {
          "part": [
           "out"
          ]
         }
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "getAttr": {
         "arg": {
          "name": "app"
         },
         "attr": "endpoints"
        }
       },
       "scopevar": "ep",
       "stmt": [
        {
         "let": {
          "name": "callList",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "stmts"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "type"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "call"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "call",
            "stmt": [
             {
              "let": {
               "name": "depList",
               "expr": {
                "transform": {
                 "arg": {
                  "binexpr": {
                   "op": "WHERE",
                   "lhs": {
                    "getAttr": {
                     "arg": {
                      "name": "module"
                     },
                     "attr": "apps"
                    }
                   },
                   "rhs": {
                    "binexpr": {
                     "op": "EQ",
                     "lhs": {
                      "getAttr": {
                       "arg": {
                        "getAttr": {
                         "arg": {
                          "name": "."
                         },
                         "attr": "value"
                        }
                       },
                       "attr": "name"
                      }
                     },
                     "rhs": {
                      "getAttr": {
                       "arg": {
                        "name": "call"
                       },
                       "attr": "target"
                      }
                     }
                    }
                   },
                   "scopevar": "."
                  }
                 },
                 "scopevar": "dep",
                 "stmt": [
                  {
                   "assign": {
                    "name": "ParameterDecl",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "dep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Identifier",
                         "expr": {
                          "binexpr": {
                           "op": "ADD",
                           "lhs": {
                            "binexpr": {
                             "op": "ADD",
                             "lhs": {
                              "getAttr": {
                               "arg": {
                                "getAttr": {
                                 "arg": {
                                  "getAttr": {
                                   "arg": {
                                    "name": "dep"
                                   },
                                   "attr": "value"
                                  }
                                 },
                                 "attr": "attrs"
                                }
                               },
                               "attr": "package"
                              }
                             },
                             "rhs": {
                              "getAttr": {
                               "arg": {
                                "getAttr": {
                                 "arg": {
                                  "name": "dep"
                                 },
                                 "attr": "value"
                                }
                               },
                               "attr": "name"
                              }
                             }
                            }
                           },
                           "rhs": {
                            "literal": {
                             "s": "Service"
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "TypeName",
                         "expr": {
                          "binexpr": {
                           "op": "ADD",
                           "lhs": {
                            "binexpr": {
                             "op": "ADD",
                             "lhs": {
                              "getAttr": {
                               "arg": {
                                "getAttr": {
                                 "arg": {
                                  "getAttr": {
                                   "arg": {
                                    "name": "dep"
                                   },
                                   "attr": "value"
                                  }
                                 },
                                 "attr": "attrs"
                                }
                               },
                               "attr": "package"
                              }
                             },
                             "rhs": {
                              "literal": {
                               "s": "."
                              }
                             }
                            }
                           },
                           "rhs": {
                            "literal": {
                             "s": "Service"
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "ParameterDecl"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "set": {
                  "typeRef": {
                   "context": {
                    "appname": {
                     "part": [
                      "CodeGenTransform"
                     ]
                    }
                   },
                   "ref": {
                    "appname": {
                     "part": [
                      "out"
                     ]
                    }
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "name": "depList"
               }
              }
             }
            ]
           },
           "type": {
            "set": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               }
              },
              "ref": {
               "appname": {
                "part": [
                 "out"
                ]
               }
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "binexpr": {
            "op": "FLATTEN",
            "lhs": {
             "name": "callList"
            },
            "rhs": {
             "getAttr": {
              "arg": {
               "name": "."
              },
              "attr": "out"
             }
            },
            "scopevar": "."
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 933,
       "col": 2
      }
     }
    },
    "makeClientParamList": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "set": {
       "primitive": "STRING",
       "constraint": [
       ]
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "getAttr": {
         "arg": {
          "name": "app"
         },
         "attr": "endpoints"
        }
       },
       "scopevar": "ep",
       "stmt": [
        {
         "let": {
          "name": "callList",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "stmts"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "type"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "call"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "call",
            "stmt": [
             {
              "let": {
               "name": "depList",
               "expr": {
                "transform": {
                 "arg": {
                  "binexpr": {
                   "op": "WHERE",
                   "lhs": {
                    "getAttr": {
                     "arg": {
                      "name": "module"
                     },
                     "attr": "apps"
                    }
                   },
                   "rhs": {
                    "binexpr": {
                     "op": "EQ",
                     "lhs": {
                      "getAttr": {
                       "arg": {
                        "getAttr": {
                         "arg": {
                          "name": "."
                         },
                         "attr": "value"
                        }
                       },
                       "attr": "name"
                      }
                     },
                     "rhs": {
                      "getAttr": {
                       "arg": {
                        "name": "call"
                       },
                       "attr": "target"
                      }
                     }
                    }
                   },
                   "scopevar": "."
                  }
                 },
                 "scopevar": "dep",
                 "stmt": [
                  {
                   "assign": {
                    "name": "out",
                    "expr": {
                     "binexpr": {
                      "op": "ADD",
                      "lhs": {
                       "binexpr": {
                        "op": "ADD",
                        "lhs": {
                         "getAttr": {
                          "arg": {
                           "getAttr": {
                            "arg": {
                             "getAttr": {
                              "arg": {
                               "name": "dep"
                              },
                              "attr": "value"
                             }
                            },
                            "attr": "attrs"
                           }
                          },
                          "attr": "package"
                         }
                        },
                        "rhs": {
                         "getAttr": {
                          "arg": {
                           "getAttr": {
                            "arg": {
                             "name": "dep"
                            },
                            "attr": "value"
                           }
                          },
                          "attr": "name"
                         }
                        }
                       }
                      },
                      "rhs": {
                       "literal": {
                        "s": "Service"
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "set": {
                  "typeRef": {
                   "context": {
                    "appname": {
                     "part": [
                      "CodeGenTransform"
                     ]
                    }
                   },
                   "ref": {
                    "appname": {
                     "part": [
                      "out"
                     ]
                    }
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "binexpr": {
                 "op": "FLATTEN",
                 "lhs": {
                  "name": "depList"
                 },
                 "rhs": {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "out"
                  }
                 },
                 "scopevar": "."
                }
               }
              }
             }
            ]
           },
           "type": {
            "set": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               }
              },
              "ref": {
               "appname": {
                "part": [
                 "out"
                ]
               }
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "binexpr": {
            "op": "FLATTEN",
            "lhs": {
             "name": "callList"
            },
            "rhs": {
             "getAttr": {
              "arg": {
               "name": "."
              },
              "attr": "out"
             }
            },
            "scopevar": "."
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 947,
       "col": 2
      }
     }
    },
    "makeClientStruct": {
     "param": [
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "set": {
       "typeRef": {
        "ref": {
         "appname": {
          "part": [
           "out"
          ]
         }
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "getAttr": {
         "arg": {
          "name": "app"
         },
         "attr": "endpoints"
        }
       },
       "scopevar": "ep",
       "stmt": [
        {
         "let": {
          "name": "callList",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "stmts"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "EQ",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "type"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "call"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "call",
            "stmt": [
             {
              "let": {
               "name": "depList",
               "expr": {
                "transform": {
                 "arg": {
                  "binexpr": {
                   "op": "WHERE",
                   "lhs": {
                    "getAttr": {
                     "arg": {
                      "name": "module"
                     },
                     "attr": "apps"
                    }
                   },
                   "rhs": {
                    "binexpr": {
                     "op": "EQ",
                     "lhs": {
                      "getAttr": {
                       "arg": {
                        "getAttr": {
                         "arg": {
                          "name": "."
                         },
                         "attr": "value"
                        }
                       },
                       "attr": "name"
                      }
                     },
                     "rhs": {
                      "getAttr": {
                       "arg": {
                        "name": "call"
                       },
                       "attr": "target"
                      }
                     }
                    }
                   },
                   "scopevar": "."
                  }
                 },
                 "scopevar": "dep",
                 "stmt": [
                  {
                   "assign": {
                    "name": "identifier",
                    "expr": {
                     "binexpr": {
                      "op": "ADD",
                      "lhs": {
                       "binexpr": {
                        "op": "ADD",
                        "lhs": {
                         "getAttr": {
                          "arg": {
                           "getAttr": {
                            "arg": {
                             "getAttr": {
                              "arg": {
                               "name": "dep"
                              },
                              "attr": "value"
                             }
                            },
                            "attr": "attrs"
                           }
                          },
                          "attr": "package"
                         }
                        },
                        "rhs": {
                         "getAttr": {
                          "arg": {
                           "getAttr": {
                            "arg": {
                             "name": "dep"
                            },
                            "attr": "value"
                           }
                          },
                          "attr": "name"
                         }
                        }
                       }
                      },
                      "rhs": {
                       "literal": {
                        "s": "Service"
                       }
                      }
                     }
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "Type",
                    "expr": {
                     "binexpr": {
                      "op": "ADD",
                      "lhs": {
                       "binexpr": {
                        "op": "ADD",
                        "lhs": {
                         "getAttr": {
                          "arg": {
                           "getAttr": {
                            "arg": {
                             "getAttr": {
                              "arg": {
                               "name": "dep"
                              },
                              "attr": "value"
                             }
                            },
                            "attr": "attrs"
                           }
                          },
                          "attr": "package"
                         }
                        },
                        "rhs": {
                         "literal": {
                          "s": "."
                         }
                        }
                       }
                      },
                      "rhs": {
                       "literal": {
                        "s": "Service"
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "set": {
                  "typeRef": {
                   "context": {
                    "appname": {
                     "part": [
                      "CodeGenTransform"
                     ]
                    }
                   },
                   "ref": {
                    "appname": {
                     "part": [
                      "out"
                     ]
                    }
                   }
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "name": "depList"
               }
              }
             }
            ]
           },
           "type": {
            "set": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               }
              },
              "ref": {
               "appname": {
                "part": [
                 "out"
                ]
               }
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "binexpr": {
            "op": "FLATTEN",
            "lhs": {
             "name": "callList"
            },
            "rhs": {
             "getAttr": {
              "arg": {
               "name": "."
              },
              "attr": "out"
             }
            },
            "scopevar": "."
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 921,
       "col": 2
      }
     }
    },
    "makeEpClientName": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "out",
          "expr": {
           "binexpr": {
            "op": "ADD",
            "lhs": {
             "getAttr": {
              "arg": {
               "call": {
                "func": "methodDef",
                "arg": [
                 {
                  "name": "ep"
                 }
                ]
               }
              },
              "attr": "methodName"
             }
            },
            "rhs": {
             "literal": {
              "s": "Client"
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 888,
       "col": 2
      }
     }
    },
    "makeFunctionCall": {
     "param": [
      {
       "name": "funcName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "arg0",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "ValueExpr"
           ]
          }
         }
        }
       }
      },
      {
       "name": "rest",
       "type": {
        "sequence": {
         "typeRef": {
          "context": {
           "appname": {
            "part": [
             "CodeGenTransform"
            ]
           },
           "path": [
            "makeFunctionCall"
           ]
          },
          "ref": {
           "path": [
            "ValueExpr"
           ]
          }
         }
        }
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "funcName"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "funcName"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "FunctionCall",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "funcName"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "FunctionName",
                    "expr": {
                     "name": "funcName"
                    }
                   }
                  },
                  {
                   "assign": {
                    "name": "FunctionArgs",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "funcName"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "name": "arg0"
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "FuncArgsRest",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "rest"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Expression",
                              "expr": {
                               "name": "."
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "FuncArgsRest"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "FunctionArgs"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "FunctionCall"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 625,
       "col": 2
      }
     }
    },
    "makeResult": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "tn",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "ep"
                  },
                  "attr": "value"
                 }
                },
                "attr": "ret"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "NE",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "key"
                 }
                },
                "rhs": {
                 "literal": {
                  "s": "error"
                 }
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "t",
            "stmt": [
             {
              "let": {
               "name": "justName",
               "expr": {
                "call": {
                 "func": "ToLower",
                 "arg": [
                  {
                   "call": {
                    "func": "TrimPrefix",
                    "arg": [
                     {
                      "getAttr": {
                       "arg": {
                        "name": "t"
                       },
                       "attr": "value"
                      }
                     },
                     {
                      "literal": {
                       "s": "sequence of "
                      }
                     }
                    ]
                   }
                  }
                 ]
                }
               }
              }
             },
             {
              "let": {
               "name": "p",
               "expr": {
                "ifelse": {
                 "cond": {
                  "call": {
                   "func": "MatchString",
                   "arg": [
                    {
                     "literal": {
                      "s": "^.+\\."
                     }
                    },
                    {
                     "name": "justName"
                    }
                   ]
                  }
                 },
                 "ifTrue": {
                  "unexpr": {
                   "op": "SINGLE",
                   "arg": {
                    "call": {
                     "func": "FindAllString",
                     "arg": [
                      {
                       "literal": {
                        "s": "^.+\\."
                       }
                      },
                      {
                       "name": "justName"
                      },
                      {
                       "literal": {
                        "i": "1"
                       }
                      }
                     ]
                    }
                   }
                  }
                 },
                 "ifFalse": {
                  "literal": {
                   "s": ""
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "call": {
                 "func": "TrimPrefix",
                 "arg": [
                  {
                   "name": "justName"
                  },
                  {
                   "name": "p"
                  }
                 ]
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "primitive": "STRING",
             "constraint": [
             ]
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "call": {
            "func": "Join",
            "arg": [
             {
              "binexpr": {
               "op": "FLATTEN",
               "lhs": {
                "name": "tn"
               },
               "rhs": {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "out"
                }
               },
               "scopevar": "."
              }
             },
             {
              "literal": {
               "s": ", "
              }
             }
            ]
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 640,
       "col": 2
      }
     }
    },
    "makeValueExpr": {
     "param": [
      {
       "name": "strValue",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Expression"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "strValue"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "ValueExpr",
          "expr": {
           "name": "strValue"
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 39,
       "col": 2
      }
     }
    },
    "methodDef": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "terms",
          "expr": {
           "transform": {
            "arg": {
             "getAttr": {
              "arg": {
               "getAttr": {
                "arg": {
                 "name": "ep"
                },
                "attr": "value"
               }
              },
              "attr": "pathvars"
             }
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "out",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "binexpr": {
                   "op": "ADD",
                   "lhs": {
                    "literal": {
                     "s": "{"
                    }
                   },
                   "rhs": {
                    "getAttr": {
                     "arg": {
                      "name": "."
                     },
                     "attr": "name"
                    }
                   }
                  }
                 },
                 "rhs": {
                  "literal": {
                   "s": "}"
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "out"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "pathVars",
          "expr": {
           "binexpr": {
            "op": "FLATTEN",
            "lhs": {
             "name": "terms"
            },
            "rhs": {
             "getAttr": {
              "arg": {
               "name": "."
              },
              "attr": "out"
             }
            },
            "scopevar": "."
           }
          }
         }
        },
        {
         "let": {
          "name": "path",
          "expr": {
           "call": {
            "func": "Split",
            "arg": [
             {
              "getAttr": {
               "arg": {
                "getAttr": {
                 "arg": {
                  "name": "ep"
                 },
                 "attr": "value"
                }
               },
               "attr": "path"
              }
             },
             {
              "literal": {
               "s": "/"
              }
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "method",
          "expr": {
           "call": {
            "func": "Title",
            "arg": [
             {
              "call": {
               "func": "ToLower",
               "arg": [
                {
                 "getAttr": {
                  "arg": {
                   "getAttr": {
                    "arg": {
                     "name": "ep"
                    },
                    "attr": "value"
                   }
                  },
                  "attr": "method"
                 }
                }
               ]
              }
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "methodPostfix",
          "expr": {
           "transform": {
            "arg": {
             "name": "path"
            },
            "scopevar": "p",
            "stmt": [
             {
              "let": {
               "name": "postfix",
               "expr": {
                "ifelse": {
                 "cond": {
                  "binexpr": {
                   "op": "IN",
                   "lhs": {
                    "name": "p"
                   },
                   "rhs": {
                    "name": "pathVars"
                   }
                  }
                 },
                 "ifTrue": {
                  "literal": {
                   "s": ""
                  }
                 },
                 "ifFalse": {
                  "name": "p"
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "out",
               "expr": {
                "call": {
                 "func": "Title",
                 "arg": [
                  {
                   "call": {
                    "func": "ToLower",
                    "arg": [
                     {
                      "name": "postfix"
                     }
                    ]
                   }
                  }
                 ]
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "primitive": "STRING",
             "constraint": [
             ]
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "withArg",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "AND",
              "lhs": {
               "call": {
                "func": "MatchString",
                "arg": [
                 {
                  "literal": {
                   "s": "\\{\\p{L}+\\}$"
                  }
                 },
                 {
                  "getAttr": {
                   "arg": {
                    "getAttr": {
                     "arg": {
                      "name": "ep"
                     },
                     "attr": "value"
                    }
                   },
                   "attr": "path"
                  }
                 }
                ]
               }
              },
              "rhs": {
               "call": {
                "func": "Contains",
                "arg": [
                 {
                  "literal": {
                   "s": "POST"
                  }
                 },
                 {
                  "call": {
                   "func": "ToUpper",
                   "arg": [
                    {
                     "name": "method"
                    }
                   ]
                  }
                 }
                ]
               }
              }
             }
            },
            "ifTrue": {
             "literal": {
              "s": "WithArg"
             }
            },
            "ifFalse": {
             "literal": {
              "s": ""
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "getList",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "AND",
              "lhs": {
               "call": {
                "func": "MatchString",
                "arg": [
                 {
                  "literal": {
                   "s": "[\\p{L}\\p{N}]$"
                  }
                 },
                 {
                  "getAttr": {
                   "arg": {
                    "getAttr": {
                     "arg": {
                      "name": "ep"
                     },
                     "attr": "value"
                    }
                   },
                   "attr": "path"
                  }
                 }
                ]
               }
              },
              "rhs": {
               "call": {
                "func": "Contains",
                "arg": [
                 {
                  "literal": {
                   "s": "GET"
                  }
                 },
                 {
                  "call": {
                   "func": "ToUpper",
                   "arg": [
                    {
                     "name": "method"
                    }
                   ]
                  }
                 }
                ]
               }
              }
             }
            },
            "ifTrue": {
             "literal": {
              "s": "List"
             }
            },
            "ifFalse": {
             "literal": {
              "s": ""
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "methodName",
          "expr": {
           "getAttr": {
            "arg": {
             "call": {
              "func": "GoName",
              "arg": [
               {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "binexpr": {
                   "op": "ADD",
                   "lhs": {
                    "binexpr": {
                     "op": "ADD",
                     "lhs": {
                      "name": "method"
                     },
                     "rhs": {
                      "call": {
                       "func": "Join",
                       "arg": [
                        {
                         "binexpr": {
                          "op": "FLATTEN",
                          "lhs": {
                           "name": "methodPostfix"
                          },
                          "rhs": {
                           "getAttr": {
                            "arg": {
                             "name": "."
                            },
                            "attr": "out"
                           }
                          },
                          "scopevar": "."
                         }
                        },
                        {
                         "literal": {
                          "s": ""
                         }
                        }
                       ]
                      }
                     }
                    }
                   },
                   "rhs": {
                    "name": "withArg"
                   }
                  }
                 },
                 "rhs": {
                  "name": "getList"
                 }
                }
               }
              ]
             }
            },
            "attr": "out"
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 347,
       "col": 2
      }
     }
    },
    "paramAssignment": {
     "param": [
      {
       "name": "param",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Parameter"
          ]
         }
        }
       }
      },
      {
       "name": "methodName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "out"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "param"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "out",
          "expr": {
           "transform": {
            "arg": {
             "name": "param"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Variables",
               "expr": {
                "getAttr": {
                 "arg": {
                  "name": "param"
                 },
                 "attr": "varName"
                }
               }
              }
             },
             {
              "assign": {
               "name": "Expression",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "param"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "FunctionCall",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "param"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "FunctionName",
                         "expr": {
                          "name": "methodName"
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "FunctionArgs",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "param"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "Expression",
                              "expr": {
                               "call": {
                                "func": "makeValueExpr",
                                "arg": [
                                 {
                                  "literal": {
                                   "s": "r"
                                  }
                                 }
                                ]
                               }
                              }
                             }
                            },
                            {
                             "assign": {
                              "name": "FuncArgsRest",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "list": {
                                  "expr": [
                                   {
                                    "name": "param"
                                   }
                                  ]
                                 }
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "Expression",
                                   "expr": {
                                    "call": {
                                     "func": "makeValueExpr",
                                     "arg": [
                                      {
                                       "binexpr": {
                                        "op": "ADD",
                                        "lhs": {
                                         "binexpr": {
                                          "op": "ADD",
                                          "lhs": {
                                           "literal": {
                                            "s": "\""
                                           }
                                          },
                                          "rhs": {
                                           "getAttr": {
                                            "arg": {
                                             "name": "param"
                                            },
                                            "attr": "paramName"
                                           }
                                          }
                                         }
                                        },
                                        "rhs": {
                                         "literal": {
                                          "s": "\""
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FuncArgsRest"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "FunctionArgs"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "FunctionCall"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Expression"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "out"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 382,
       "col": 2
      }
     }
    },
    "paramDecl": {
     "param": [
      {
       "name": "identifier",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "typeName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "ParameterDecl"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "identifier"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "Identifier",
          "expr": {
           "name": "identifier"
          }
         }
        },
        {
         "assign": {
          "name": "TypeName",
          "expr": {
           "name": "typeName"
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 44,
       "col": 2
      }
     }
    },
    "queryParamName": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      },
      {
       "name": "qparam",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "EndPoint",
           "RestParams",
           "QueryParam"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "out",
          "expr": {
           "ifelse": {
            "cond": {
             "binexpr": {
              "op": "IN",
              "lhs": {
               "literal": {
                "s": "queryParamNames"
               }
              },
              "rhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "."
                  },
                  "attr": "value"
                 }
                },
                "attr": "attrs"
               }
              }
             }
            },
            "ifTrue": {
             "getAttr": {
              "arg": {
               "call": {
                "func": "queryParamNameFromAttrs",
                "arg": [
                 {
                  "name": "ep"
                 },
                 {
                  "name": "qparam"
                 }
                ]
               }
              },
              "attr": "out"
             }
            },
            "ifFalse": {
             "getAttr": {
              "arg": {
               "name": "qparam"
              },
              "attr": "name"
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 536,
       "col": 2
      }
     }
    },
    "queryParamNameFromAttrs": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      },
      {
       "name": "qparam",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "EndPoint",
           "RestParams",
           "QueryParam"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "primitive": "STRING",
      "constraint": [
      ]
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "matchingPname",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "getAttr": {
                    "arg": {
                     "name": "."
                    },
                    "attr": "value"
                   }
                  },
                  "attr": "attrs"
                 }
                },
                "attr": "queryParamNames"
               }
              },
              "rhs": {
               "binexpr": {
                "op": "IN",
                "lhs": {
                 "getAttr": {
                  "arg": {
                   "name": "qparam"
                  },
                  "attr": "name"
                 }
                },
                "rhs": {
                 "name": "."
                }
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "namePair",
            "stmt": [
             {
              "assign": {
               "name": "mpout",
               "expr": {
                "binexpr": {
                 "op": "WHERE",
                 "lhs": {
                  "name": "namePair"
                 },
                 "rhs": {
                  "binexpr": {
                   "op": "NE",
                   "lhs": {
                    "name": "."
                   },
                   "rhs": {
                    "getAttr": {
                     "arg": {
                      "name": "qparam"
                     },
                     "attr": "name"
                    }
                   }
                  }
                 },
                 "scopevar": "."
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "primitive": "STRING",
             "constraint": [
             ]
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "matchingPnameAsString",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "FLATTEN",
              "lhs": {
               "name": "matchingPname"
              },
              "rhs": {
               "getAttr": {
                "arg": {
                 "name": "."
                },
                "attr": "mpout"
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "v",
            "stmt": [
             {
              "assign": {
               "name": "mpasout",
               "expr": {
                "call": {
                 "func": "Join",
                 "arg": [
                  {
                   "name": "v"
                  },
                  {
                   "literal": {
                    "s": ""
                   }
                  }
                 ]
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "primitive": "STRING",
             "constraint": [
             ]
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "out",
          "expr": {
           "call": {
            "func": "Join",
            "arg": [
             {
              "binexpr": {
               "op": "FLATTEN",
               "lhs": {
                "name": "matchingPnameAsString"
               },
               "rhs": {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "mpasout"
                }
               },
               "scopevar": "."
              }
             },
             {
              "literal": {
               "s": ""
              }
             }
            ]
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 524,
       "col": 2
      }
     }
    },
    "retrieveDBHandle": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Block"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "ep"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "vars",
          "expr": {
           "literal": {
            "s": "conn,err"
           }
          }
         }
        },
        {
         "let": {
          "name": "funcName",
          "expr": {
           "literal": {
            "s": "s.DB.Conn"
           }
          }
         }
        },
        {
         "let": {
          "name": "validate",
          "expr": {
           "transform": {
            "arg": {
             "name": "ep"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "ep"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "DeclareAndAssignStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Variables",
                         "expr": {
                          "name": "vars"
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "name": "funcName"
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "FunctionArgs",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "funcName"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "call": {
                                          "func": "makeValueExpr",
                                          "arg": [
                                           {
                                            "literal": {
                                             "s": "ctx"
                                            }
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionArgs"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Expression"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "DeclareAndAssignStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "handle",
          "expr": {
           "call": {
            "func": "handleError",
            "arg": [
             {
              "binexpr": {
               "op": "ADD",
               "lhs": {
                "literal": {
                 "s": "err"
                }
               },
               "rhs": {
                "literal": {
                 "s": " != nil"
                }
               }
              }
             },
             {
              "literal": {
               "s": "common.InternalError"
              }
             },
             {
              "literal": {
               "s": "\"Database connection could not be retrieved\""
              }
             },
             {
              "literal": {
               "s": "err"
              }
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "deferCloseConnection",
          "expr": {
           "literal": {
            "s": "defer conn.Close"
           }
          }
         }
        },
        {
         "let": {
          "name": "closeConnection",
          "expr": {
           "transform": {
            "arg": {
             "name": "deferCloseConnection"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "deferCloseConnection"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "FunctionCall",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "deferCloseConnection"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "FunctionName",
                         "expr": {
                          "name": "deferCloseConnection"
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "FunctionCall"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "queryStatements",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "name": "ep"
                },
                "attr": "attrs"
               }
              },
              "rhs": {
               "call": {
                "func": "HasPrefix",
                "arg": [
                 {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "key"
                  }
                 },
                 {
                  "literal": {
                   "s": "sql_"
                  }
                 }
                ]
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "t",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "t"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "DeclareAndAssignStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "t"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "let": {
                         "name": "functName",
                         "expr": {
                          "call": {
                           "func": "ToLower",
                           "arg": [
                            {
                             "call": {
                              "func": "TrimPrefix",
                              "arg": [
                               {
                                "getAttr": {
                                 "arg": {
                                  "name": "t"
                                 },
                                 "attr": "key"
                                }
                               },
                               {
                                "literal": {
                                 "s": "sql_"
                                }
                               }
                              ]
                             }
                            }
                           ]
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Variables",
                         "expr": {
                          "binexpr": {
                           "op": "ADD",
                           "lhs": {
                            "binexpr": {
                             "op": "ADD",
                             "lhs": {
                              "name": "functName"
                             },
                             "rhs": {
                              "literal": {
                               "s": "Stmt, err_"
                              }
                             }
                            }
                           },
                           "rhs": {
                            "name": "functName"
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "t"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "t"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "literal": {
                                     "s": "conn.PrepareContext"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "FunctionArgs",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "literal": {
                                       "s": "conn.PrepareContext"
                                      }
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "call": {
                                          "func": "makeValueExpr",
                                          "arg": [
                                           {
                                            "literal": {
                                             "s": "ctx"
                                            }
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      },
                                      {
                                       "assign": {
                                        "name": "FuncArgsRest",
                                        "expr": {
                                         "transform": {
                                          "arg": {
                                           "list": {
                                            "expr": [
                                             {
                                              "name": "t"
                                             }
                                            ]
                                           }
                                          },
                                          "scopevar": "a",
                                          "stmt": [
                                           {
                                            "assign": {
                                             "name": "Expression",
                                             "expr": {
                                              "call": {
                                               "func": "makeValueExpr",
                                               "arg": [
                                                {
                                                 "binexpr": {
                                                  "op": "ADD",
                                                  "lhs": {
                                                   "binexpr": {
                                                    "op": "ADD",
                                                    "lhs": {
                                                     "literal": {
                                                      "s": "\""
                                                     }
                                                    },
                                                    "rhs": {
                                                     "getAttr": {
                                                      "arg": {
                                                       "name": "t"
                                                      },
                                                      "attr": "value"
                                                     }
                                                    }
                                                   }
                                                  },
                                                  "rhs": {
                                                   "literal": {
                                                    "s": "\""
                                                   }
                                                  }
                                                 }
                                                }
                                               ]
                                              }
                                             }
                                            }
                                           }
                                          ]
                                         },
                                         "type": {
                                          "sequence": {
                                           "typeRef": {
                                            "context": {
                                             "appname": {
                                              "part": [
                                               "CodeGenTransform"
                                              ]
                                             },
                                             "path": [
                                              "retrieveDBHandle"
                                             ]
                                            },
                                            "ref": {
                                             "path": [
                                              "FuncArgsRest"
                                             ]
                                            }
                                           }
                                          }
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionArgs"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Expression"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "DeclareAndAssignStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "retrieveDBHandle"
               ]
              },
              "ref": {
               "path": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "queryErrors",
          "expr": {
           "transform": {
            "arg": {
             "binexpr": {
              "op": "WHERE",
              "lhs": {
               "getAttr": {
                "arg": {
                 "name": "ep"
                },
                "attr": "attrs"
               }
              },
              "rhs": {
               "call": {
                "func": "HasPrefix",
                "arg": [
                 {
                  "getAttr": {
                   "arg": {
                    "name": "."
                   },
                   "attr": "key"
                  }
                 },
                 {
                  "literal": {
                   "s": "sql_"
                  }
                 }
                ]
               }
              },
              "scopevar": "."
             }
            },
            "scopevar": "t",
            "stmt": [
             {
              "let": {
               "name": "functName",
               "expr": {
                "call": {
                 "func": "ToLower",
                 "arg": [
                  {
                   "call": {
                    "func": "TrimPrefix",
                    "arg": [
                     {
                      "getAttr": {
                       "arg": {
                        "name": "t"
                       },
                       "attr": "key"
                      }
                     },
                     {
                      "literal": {
                       "s": "sql_"
                      }
                     }
                    ]
                   }
                  }
                 ]
                }
               }
              }
             },
             {
              "let": {
               "name": "errorMessage",
               "expr": {
                "binexpr": {
                 "op": "ADD",
                 "lhs": {
                  "binexpr": {
                   "op": "ADD",
                   "lhs": {
                    "literal": {
                     "s": "\"could not parse the sql query with the name "
                    }
                   },
                   "rhs": {
                    "getAttr": {
                     "arg": {
                      "name": "t"
                     },
                     "attr": "key"
                    }
                   }
                  }
                 },
                 "rhs": {
                  "literal": {
                   "s": "\""
                  }
                 }
                }
               }
              }
             },
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "getAttr": {
                 "arg": {
                  "call": {
                   "func": "handleError",
                   "arg": [
                    {
                     "binexpr": {
                      "op": "ADD",
                      "lhs": {
                       "binexpr": {
                        "op": "ADD",
                        "lhs": {
                         "literal": {
                          "s": "err_"
                         }
                        },
                        "rhs": {
                         "name": "functName"
                        }
                       }
                      },
                      "rhs": {
                       "literal": {
                        "s": " != nil"
                       }
                      }
                     }
                    },
                    {
                     "literal": {
                      "s": "common.InternalError"
                     }
                    },
                    {
                     "name": "errorMessage"
                    },
                    {
                     "binexpr": {
                      "op": "ADD",
                      "lhs": {
                       "literal": {
                        "s": "err_"
                       }
                      },
                      "rhs": {
                       "name": "functName"
                      }
                     }
                    }
                   ]
                  }
                 },
                 "attr": "Statement"
                }
               }
              }
             }
            ]
           },
           "type": {
            "sequence": {
             "typeRef": {
              "context": {
               "appname": {
                "part": [
                 "CodeGenTransform"
                ]
               },
               "path": [
                "retrieveDBHandle"
               ]
              },
              "ref": {
               "path": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "createTransaction",
          "expr": {
           "transform": {
            "arg": {
             "name": "ep"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "ep"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "DeclareAndAssignStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "ep"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Variables",
                         "expr": {
                          "literal": {
                           "s": "tx, err"
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "ep"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "ep"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "literal": {
                                     "s": "conn.BeginTx"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "FunctionArgs",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "literal": {
                                       "s": "conn.BeginTx"
                                      }
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "call": {
                                          "func": "makeValueExpr",
                                          "arg": [
                                           {
                                            "literal": {
                                             "s": "ctx, \u0026sql.TxOptions{Isolation: sql.LevelSerializable}"
                                            }
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionArgs"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Expression"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "DeclareAndAssignStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "transactionError",
          "expr": {
           "call": {
            "func": "handleError",
            "arg": [
             {
              "binexpr": {
               "op": "ADD",
               "lhs": {
                "literal": {
                 "s": "err"
                }
               },
               "rhs": {
                "literal": {
                 "s": " != nil"
                }
               }
              }
             },
             {
              "literal": {
               "s": "common.DownstreamUnavailableError"
              }
             },
             {
              "literal": {
               "s": "\"DB Transaction could not be created\""
              }
             },
             {
              "literal": {
               "s": "err"
              }
             }
            ]
           }
          }
         }
        },
        {
         "assign": {
          "name": "StatementList",
          "expr": {
           "binexpr": {
            "op": "BITOR",
            "lhs": {
             "binexpr": {
              "op": "BITOR",
              "lhs": {
               "binexpr": {
                "op": "BITOR",
                "lhs": {
                 "list": {
                  "expr": [
                   {
                    "name": "validate"
                   },
                   {
                    "name": "handle"
                   },
                   {
                    "name": "closeConnection"
                   }
                  ]
                 }
                },
                "rhs": {
                 "name": "queryStatements"
                }
               }
              },
              "rhs": {
               "name": "queryErrors"
              }
             }
            },
            "rhs": {
             "list": {
              "expr": [
               {
                "name": "createTransaction"
               },
               {
                "name": "transactionError"
               }
              ]
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 224,
       "col": 2
      }
     }
    },
    "setServiceHandlerWithDBPool": {
     "param": [
      {
       "name": "request",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      },
      {
       "name": "serviceImplVarname",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Block"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "request"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "vars",
          "expr": {
           "literal": {
            "s": "db,err"
           }
          }
         }
        },
        {
         "let": {
          "name": "dbHandle",
          "expr": {
           "transform": {
            "arg": {
             "name": "request"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "request"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "DeclareAndAssignStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "request"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Variables",
                         "expr": {
                          "name": "vars"
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "request"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "request"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "literal": {
                                     "s": "database.GetDBHandle"
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Expression"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "DeclareAndAssignStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "errorHandle",
          "expr": {
           "call": {
            "func": "handleErrorReturnNil",
            "arg": [
             {
              "binexpr": {
               "op": "ADD",
               "lhs": {
                "literal": {
                 "s": "err"
                }
               },
               "rhs": {
                "literal": {
                 "s": " != nil"
                }
               }
              }
             }
            ]
           }
          }
         }
        },
        {
         "let": {
          "name": "returnStmt",
          "expr": {
           "transform": {
            "arg": {
             "name": "request"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "request"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "ReturnStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "request"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "let": {
                         "name": "clientParamList",
                         "expr": {
                          "transform": {
                           "arg": {
                            "binexpr": {
                             "op": "FLATTEN",
                             "lhs": {
                              "call": {
                               "func": "makeClientParamList",
                               "arg": [
                                {
                                 "name": "app"
                                },
                                {
                                 "name": "module"
                                }
                               ]
                              }
                             },
                             "rhs": {
                              "getAttr": {
                               "arg": {
                                "name": "."
                               },
                               "attr": "out"
                              }
                             },
                             "scopevar": "."
                            }
                           },
                           "scopevar": "pl",
                           "stmt": [
                            {
                             "assign": {
                              "name": "out",
                              "expr": {
                               "name": "pl"
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "set": {
                            "typeRef": {
                             "context": {
                              "appname": {
                               "part": [
                                "CodeGenTransform"
                               ]
                              }
                             },
                             "ref": {
                              "appname": {
                               "part": [
                                "out"
                               ]
                              }
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "PayLoad",
                         "expr": {
                          "binexpr": {
                           "op": "ADD",
                           "lhs": {
                            "binexpr": {
                             "op": "ADD",
                             "lhs": {
                              "literal": {
                               "s": "\u0026ServiceHandler{"
                              }
                             },
                             "rhs": {
                              "call": {
                               "func": "Join",
                               "arg": [
                                {
                                 "binexpr": {
                                  "op": "BITOR",
                                  "lhs": {
                                   "list": {
                                    "expr": [
                                     {
                                      "literal": {
                                       "s": "genCallback"
                                      }
                                     },
                                     {
                                      "name": "serviceImplVarname"
                                     },
                                     {
                                      "literal": {
                                       "s": "db"
                                      }
                                     }
                                    ]
                                   }
                                  },
                                  "rhs": {
                                   "binexpr": {
                                    "op": "FLATTEN",
                                    "lhs": {
                                     "name": "clientParamList"
                                    },
                                    "rhs": {
                                     "getAttr": {
                                      "arg": {
                                       "name": "."
                                      },
                                      "attr": "out"
                                     }
                                    },
                                    "scopevar": "."
                                   }
                                  }
                                 }
                                },
                                {
                                 "literal": {
                                  "s": ","
                                 }
                                }
                               ]
                              }
                             }
                            }
                           },
                           "rhs": {
                            "literal": {
                             "s": "}"
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "ReturnStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "StatementList",
          "expr": {
           "list": {
            "expr": [
             {
              "name": "dbHandle"
             },
             {
              "name": "errorHandle"
             },
             {
              "name": "returnStmt"
             }
            ]
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 302,
       "col": 2
      }
     }
    },
    "setServiceHandlerWithoutDBPool": {
     "param": [
      {
       "name": "request",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "app",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "App"
          ]
         }
        }
       }
      },
      {
       "name": "module",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Module"
          ]
         }
        }
       }
      },
      {
       "name": "serviceImplVarname",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Block"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "request"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "returnStmt",
          "expr": {
           "transform": {
            "arg": {
             "name": "request"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "request"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "ReturnStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "request"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "let": {
                         "name": "clientParamList",
                         "expr": {
                          "transform": {
                           "arg": {
                            "binexpr": {
                             "op": "FLATTEN",
                             "lhs": {
                              "call": {
                               "func": "makeClientParamList",
                               "arg": [
                                {
                                 "name": "app"
                                },
                                {
                                 "name": "module"
                                }
                               ]
                              }
                             },
                             "rhs": {
                              "getAttr": {
                               "arg": {
                                "name": "."
                               },
                               "attr": "out"
                              }
                             },
                             "scopevar": "."
                            }
                           },
                           "scopevar": "pl",
                           "stmt": [
                            {
                             "assign": {
                              "name": "out",
                              "expr": {
                               "name": "pl"
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "set": {
                            "typeRef": {
                             "context": {
                              "appname": {
                               "part": [
                                "CodeGenTransform"
                               ]
                              }
                             },
                             "ref": {
                              "appname": {
                               "part": [
                                "out"
                               ]
                              }
                             }
                            }
                           }
                          }
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "PayLoad",
                         "expr": {
                          "binexpr": {
                           "op": "ADD",
                           "lhs": {
                            "binexpr": {
                             "op": "ADD",
                             "lhs": {
                              "literal": {
                               "s": "\u0026ServiceHandler{"
                              }
                             },
                             "rhs": {
                              "call": {
                               "func": "Join",
                               "arg": [
                                {
                                 "binexpr": {
                                  "op": "BITOR",
                                  "lhs": {
                                   "list": {
                                    "expr": [
                                     {
                                      "literal": {
                                       "s": "genCallback"
                                      }
                                     },
                                     {
                                      "name": "serviceImplVarname"
                                     }
                                    ]
                                   }
                                  },
                                  "rhs": {
                                   "binexpr": {
                                    "op": "FLATTEN",
                                    "lhs": {
                                     "name": "clientParamList"
                                    },
                                    "rhs": {
                                     "getAttr": {
                                      "arg": {
                                       "name": "."
                                      },
                                      "attr": "out"
                                     }
                                    },
                                    "scopevar": "."
                                   }
                                  }
                                 }
                                },
                                {
                                 "literal": {
                                  "s": ","
                                 }
                                }
                               ]
                              }
                             }
                            }
                           },
                           "rhs": {
                            "literal": {
                             "s": "}"
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "ReturnStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "StatementList",
          "expr": {
           "list": {
            "expr": [
             {
              "name": "returnStmt"
             }
            ]
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 332,
       "col": 2
      }
     }
    },
    "structVarDecl": {
     "param": [
      {
       "name": "bodyParams",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "BodyParams"
           ]
          }
         }
        }
       }
      }
     ],
     "retType": {
      "sequence": {
       "typeRef": {
        "context": {
         "appname": {
          "part": [
           "CodeGenTransform"
          ]
         },
         "path": [
          "structVarDecl"
         ]
        },
        "ref": {
         "path": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "bodyParams"
       },
       "scopevar": "param",
       "stmt": [
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "transform": {
            "arg": {
             "name": "param"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "VarDecl",
               "expr": {
                "call": {
                 "func": "varDecl",
                 "arg": [
                  {
                   "getAttr": {
                    "arg": {
                     "name": "param"
                    },
                    "attr": "paramName"
                   }
                  },
                  {
                   "getAttr": {
                    "arg": {
                     "name": "param"
                    },
                    "attr": "paramType"
                   }
                  }
                 ]
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "Statement"
               ]
              }
             }
            }
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 168,
       "col": 2
      }
     }
    },
    "validateHeaders": {
     "param": [
      {
       "name": "ep",
       "type": {
        "typeRef": {
         "ref": {
          "appname": {
           "part": [
            "sysl"
           ]
          },
          "path": [
           "Endpoint"
          ]
         }
        }
       }
      }
     ],
     "retType": {
      "sequence": {
       "typeRef": {
        "context": {
         "appname": {
          "part": [
           "CodeGenTransform"
          ]
         },
         "path": [
          "validateHeaders"
         ]
        },
        "ref": {
         "path": [
          "StatementList"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "binexpr": {
         "op": "WHERE",
         "lhs": {
          "getAttr": {
           "arg": {
            "getAttr": {
             "arg": {
              "name": "ep"
             },
             "attr": "value"
            }
           },
           "attr": "params"
          }
         },
         "rhs": {
          "binexpr": {
           "op": "AND",
           "lhs": {
            "binexpr": {
             "op": "IN",
             "lhs": {
              "literal": {
               "s": "header"
              }
             },
             "rhs": {
              "getAttr": {
               "arg": {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "attrs"
                }
               },
               "attr": "patterns"
              }
             }
            }
           },
           "rhs": {
            "binexpr": {
             "op": "IN",
             "lhs": {
              "literal": {
               "s": "required"
              }
             },
             "rhs": {
              "getAttr": {
               "arg": {
                "getAttr": {
                 "arg": {
                  "name": "."
                 },
                 "attr": "attrs"
                }
               },
               "attr": "patterns"
              }
             }
            }
           }
          }
         },
         "scopevar": "."
        }
       },
       "scopevar": "param",
       "stmt": [
        {
         "let": {
          "name": "condition",
          "expr": {
           "binexpr": {
            "op": "ADD",
            "lhs": {
             "getAttr": {
              "arg": {
               "call": {
                "func": "GoName",
                "arg": [
                 {
                  "getAttr": {
                   "arg": {
                    "getAttr": {
                     "arg": {
                      "name": "param"
                     },
                     "attr": "attrs"
                    }
                   },
                   "attr": "name"
                  }
                 }
                ]
               }
              },
              "attr": "out"
             }
            },
            "rhs": {
             "literal": {
              "s": " == \"\""
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "errorCode",
          "expr": {
           "literal": {
            "s": "common.BadRequestError"
           }
          }
         }
        },
        {
         "let": {
          "name": "errMsg",
          "expr": {
           "binexpr": {
            "op": "ADD",
            "lhs": {
             "binexpr": {
              "op": "ADD",
              "lhs": {
               "literal": {
                "s": "\""
               }
              },
              "rhs": {
               "getAttr": {
                "arg": {
                 "getAttr": {
                  "arg": {
                   "name": "param"
                  },
                  "attr": "attrs"
                 }
                },
                "attr": "name"
               }
              }
             }
            },
            "rhs": {
             "literal": {
              "s": " header length is zero\""
             }
            }
           }
          }
         }
        },
        {
         "assign": {
          "name": "Statement",
          "expr": {
           "getAttr": {
            "arg": {
             "call": {
              "func": "handleError",
              "arg": [
               {
                "name": "condition"
               },
               {
                "name": "errorCode"
               },
               {
                "name": "errMsg"
               },
               {
                "literal": {
                 "s": "nil"
                }
               }
              ]
             }
            },
            "attr": "Statement"
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 480,
       "col": 2
      }
     }
    },
    "validateRequest": {
     "param": [
      {
       "name": "request",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "Block"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "request"
       },
       "scopevar": ".",
       "stmt": [
        {
         "let": {
          "name": "valErr",
          "expr": {
           "literal": {
            "s": "valErr"
           }
          }
         }
        },
        {
         "let": {
          "name": "validate",
          "expr": {
           "transform": {
            "arg": {
             "name": "request"
            },
            "scopevar": ".",
            "stmt": [
             {
              "assign": {
               "name": "Statement",
               "expr": {
                "transform": {
                 "arg": {
                  "name": "request"
                 },
                 "scopevar": ".",
                 "stmt": [
                  {
                   "assign": {
                    "name": "DeclareAndAssignStmt",
                    "expr": {
                     "transform": {
                      "arg": {
                       "name": "request"
                      },
                      "scopevar": ".",
                      "stmt": [
                       {
                        "assign": {
                         "name": "Variables",
                         "expr": {
                          "name": "valErr"
                         }
                        }
                       },
                       {
                        "assign": {
                         "name": "Expression",
                         "expr": {
                          "transform": {
                           "arg": {
                            "name": "request"
                           },
                           "scopevar": ".",
                           "stmt": [
                            {
                             "assign": {
                              "name": "FunctionCall",
                              "expr": {
                               "transform": {
                                "arg": {
                                 "name": "request"
                                },
                                "scopevar": ".",
                                "stmt": [
                                 {
                                  "assign": {
                                   "name": "FunctionName",
                                   "expr": {
                                    "literal": {
                                     "s": "validator.Validate"
                                    }
                                   }
                                  }
                                 },
                                 {
                                  "assign": {
                                   "name": "FunctionArgs",
                                   "expr": {
                                    "transform": {
                                     "arg": {
                                      "name": "request"
                                     },
                                     "scopevar": ".",
                                     "stmt": [
                                      {
                                       "assign": {
                                        "name": "Expression",
                                        "expr": {
                                         "call": {
                                          "func": "makeValueExpr",
                                          "arg": [
                                           {
                                            "name": "request"
                                           }
                                          ]
                                         }
                                        }
                                       }
                                      }
                                     ]
                                    },
                                    "type": {
                                     "typeRef": {
                                      "context": {
                                       "appname": {
                                        "part": [
                                         "CodeGenTransform"
                                        ]
                                       }
                                      },
                                      "ref": {
                                       "appname": {
                                        "part": [
                                         "FunctionArgs"
                                        ]
                                       }
                                      }
                                     }
                                    }
                                   }
                                  }
                                 }
                                ]
                               },
                               "type": {
                                "typeRef": {
                                 "context": {
                                  "appname": {
                                   "part": [
                                    "CodeGenTransform"
                                   ]
                                  }
                                 },
                                 "ref": {
                                  "appname": {
                                   "part": [
                                    "FunctionCall"
                                   ]
                                  }
                                 }
                                }
                               }
                              }
                             }
                            }
                           ]
                          },
                          "type": {
                           "typeRef": {
                            "context": {
                             "appname": {
                              "part": [
                               "CodeGenTransform"
                              ]
                             }
                            },
                            "ref": {
                             "appname": {
                              "part": [
                               "Expression"
                              ]
                             }
                            }
                           }
                          }
                         }
                        }
                       }
                      ]
                     },
                     "type": {
                      "typeRef": {
                       "context": {
                        "appname": {
                         "part": [
                          "CodeGenTransform"
                         ]
                        }
                       },
                       "ref": {
                        "appname": {
                         "part": [
                          "DeclareAndAssignStmt"
                         ]
                        }
                       }
                      }
                     }
                    }
                   }
                  }
                 ]
                },
                "type": {
                 "typeRef": {
                  "context": {
                   "appname": {
                    "part": [
                     "CodeGenTransform"
                    ]
                   }
                  },
                  "ref": {
                   "appname": {
                    "part": [
                     "Statement"
                    ]
                   }
                  }
                 }
                }
               }
              }
             }
            ]
           },
           "type": {
            "typeRef": {
             "context": {
              "appname": {
               "part": [
                "CodeGenTransform"
               ]
              }
             },
             "ref": {
              "appname": {
               "part": [
                "StatementList"
               ]
              }
             }
            }
           }
          }
         }
        },
        {
         "let": {
          "name": "handle",
          "expr": {
           "call": {
            "func": "handleError",
            "arg": [
             {
              "binexpr": {
               "op": "ADD",
               "lhs": {
                "name": "valErr"
               },
               "rhs": {
                "literal": {
                 "s": " != nil"
                }
               }
              }
             },
             {
              "literal": {
               "s": "common.BadRequestError"
              }
             },
             {
              "literal": {
               "s": "\"Invalid request\""
              }
             },
             {
              "name": "valErr"
             }
            ]
           }
          }
         }
        },
        {
         "assign": {
          "name": "StatementList",
          "expr": {
           "list": {
            "expr": [
             {
              "name": "validate"
             },
             {
              "name": "handle"
             }
            ]
           }
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 199,
       "col": 2
      }
     }
    },
    "varDecl": {
     "param": [
      {
       "name": "name",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      },
      {
       "name": "typeName",
       "type": {
        "primitive": "STRING",
        "constraint": [
        ]
       }
      }
     ],
     "retType": {
      "typeRef": {
       "ref": {
        "appname": {
         "part": [
          "VarDecl"
         ]
        }
       }
      }
     },
     "expr": {
      "transform": {
       "arg": {
        "name": "name"
       },
       "scopevar": ".",
       "stmt": [
        {
         "assign": {
          "name": "identifier",
          "expr": {
           "name": "name"
          }
         }
        },
        {
         "assign": {
          "name": "TypeName",
          "expr": {
           "name": "typeName"
          }
         }
        }
       ]
      }
     },
     "sourceContext": {
      "file": "/codegen/transforms/svc_handler.sysl",
      "start": {
       "line": 50,
       "col": 2
      }
     }
    }
   },
   "sourceContext": {
    "file": "/codegen/transforms/svc_handler.sysl",
    "start": {
     "line": 1,
     "col": 1
    }
   }
  }
 }
}